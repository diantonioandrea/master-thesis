This chapter presents an application of the \acrshort{dgm} developed in \Cref{chapter:dg} to \acrshort{cdr} problems.

\Cref{sec:cdr_introduction} specializes the setting presented in \Cref{chapter:dg} and introduces the \acrshort{cdr} problem, for which the weak formulation is provided in \Cref{sec:cdr_weak}. \Cref{sec:cdr_discretization} is primarily concerned with the space and time discretization of the problem, formulating the discrete problem whose implementation is presented in \Cref{chapter:implementation}. Finally, \Cref{sec:cdr_error_analysis} provides the error analysis of the method, with estimates that serve as the main justification for the tests discussed in \Cref{chapter:results}.

Only the relevant proofs are included, while the remaining ones can be found in \citetitle{Feistauer2004} and \citetitle{Feistauer2007}.

\newpage
\section{Setting and Strong Formulation} \label{sec:cdr_introduction}

Following \cite{Feistauer2004}, let $\Omega \in \RealNumbersTo{d}$ be a bounded domain and $T > 0$ so that $I = \left( 0, T\right)$.

Consider, in what follows, the case where $d \in \left\{ 2, 3 \right\}$ and $\Omega$ is a bounded polytopal domain.

To fix the notation, let $\lambda$ denote the Lebesgue measure on $\RealNumbers$ and $\omega$ denote the Lebesgue measure on $\Omega$. Accordingly, $\lambda$-a.e. and $\omega$-a.e. refer to almost everywhere with respect to $\lambda$ and $\omega$, respectively. For brevity, these will be denoted simply as a.e. when the measure is clear from the context, and $d\lambda(t)$ will be written as $dt$.

Consider the following problem, that is to find $u \colon I \times \Omega \rightarrow \RealNumbers$ such that:
\begin{align}
    \partial_t u + \Convection \cdot \Gradient u - \Diffusion \Laplacian u + \Reaction u &= g &\text{ in } I \times \Omega, \label{equation:cdr}
\end{align}
with the following initial-boundary conditions:
\begin{align}
    u(t, \Vektor{x}) &= u_D(t, \Vektor{x}) &\text{for all } t, \Vektor{x} \in I \times \partial \Omega^-, \label{equation:cdr_dirichlet} \\
    \Diffusion \partial_{\Vektor{n}} u(t, \Vektor{x}) &= u_N(t, \Vektor{x}) &\text{for all } t, \Vektor{x} \in I \times \partial \Omega^+, \label{equation:cdr_neumann} \\
    u(0, \Vektor{x}) &= u_0(\Vektor{x}) &\text{for all } \Vektor{x} \in \Omega, \label{equation:cdr_initial}
\end{align}
and where:
\begin{align}
    \Convection & \colon I \times \Omega \rightarrow \RealNumbersTo{d}, \\
    \Diffusion & \geq 0, \\
    \Reaction & \colon I \times \Omega \rightarrow \RealNumbers,
\end{align}
are respectively the convection, diffusion and reaction coefficients, and:
\begin{align}
    \Vektor{n} \colon \partial \Omega \rightarrow \RealNumbersTo{d},
\end{align}
is the unit outer normal with respect to $\partial \Omega$.

Assume that $\partial \Omega = \partial \Omega^- \cup \partial \Omega^+$ where:
\begin{align}
    \partial \Omega^- = \left\{ \Vektor{x} \in \partial \Omega \text{ such that } \Convection(t, \Vektor{x}) \cdot \Vektor{n}(\Vektor{x}) < 0 \text{ for all } t \in \overline{I} \right\}, \\
    \partial \Omega^+ = \left\{ \Vektor{x} \in \partial \Omega \text{ such that } \Convection(t, \Vektor{x}) \cdot \Vektor{n}(\Vektor{x}) \geq 0 \text{ for all } t \in \overline{I} \right\},
\end{align}
namely the inflow and outflow parts of $\partial \Omega$.

\newpage
\section{Weak Formulation} \label{sec:cdr_weak}

\subsection{Data Assumptions} \label{assumptions}

Assume that:
\begin{align}
    g & \in C^0(\overline{I}; \SpaceLp{2}(\Omega)), \label{equation:ass_1} \\
    u_0 & \in \SpaceLp{2}(\Omega), \label{equation:ass_2} \\
    u_N & \in C^0(\overline{I}; \SpaceLp{2}(\partial \Omega^+)), \label{equation:ass_3}
\end{align}
and that there exists $u^* \in C^0(\overline{I}; \SpaceHk{1}(\Omega)) \cap \SpaceLp{\infty}(I \times \Omega)$ such that $u_D$ is the trace of $u^*$ on $I \times \partial \Omega^-$.

Moreover, assume that:
\begin{align}
    \Convection & \in \left[ C^0(\overline{I}; \SpaceWkp{1}{\infty}(\Omega)) \right]^2, \label{equation:ass_4} \\
    \Reaction & \in C^0(\overline{I}; \SpaceLp{\infty}(\Omega)), \label{equation:ass_5}
\end{align}
with $\BoundC{\Convection}, \BoundC{\Reaction} > 0$ such that:
\begin{align}
    \left\lVert \Convection(t, \Vektor{x}) \right\rVert & \leq \BoundC{\Convection} &\text{for a.e. } t, \Vektor{x} \in I \times \Omega, \label{equation:ass_6} \\
    \left\lvert \Divergence \Convection(t, \Vektor{x}) \right\rvert & \leq \BoundC{\Convection} &\text{for a.e. } t, \Vektor{x} \in I \times \Omega, \label{equation:ass_7} \\
    \left\lvert \Reaction(t, \Vektor{x}) \right\rvert & \leq \BoundC{\Reaction} &\text{for a.e. } t, \Vektor{x} \in I \times \Omega. \label{equation:ass_8}
\end{align}

Finally, assume that there exists $\BoundC{\Reaction \Convection} > 0$ such that:
\begin{align}
    \Reaction(t, \Vektor{x}) - \frac{1}{2} \Divergence \Convection(t, \Vektor{x}) & \geq \BoundC{\Reaction \Convection} &\text{for a.e. } t, \Vektor{x} \in I \times \Omega. \label{equation:ass_9}
\end{align}

\newpage
\subsection{Weak Solution}

Set now $V = \left\{ v \in \SpaceHk{1}(\Omega) \text{ such that } v \Restriction_{\partial \Omega^-} = 0 \right\}$.

\begin{definition}[Weak solution]
    The weak solution $u$ is such that: 
    \begin{align}
        u &\in \SpaceLp{\infty}(I \times \Omega), \\
        u - u^* &\in \SpaceLp{2}(I; V), 
        u(0) &= u_0 &\text{in } \Omega.
    \end{align}
    Moreover:
    \begin{align}
        \partial_t \int_{\Omega} u w ~ d \omega(\Vektor{x}) &+ \Diffusion \int_{\Omega} \Gradient u \cdot \Gradient w ~ d \omega(\Vektor{x}) + \int_{\partial \Omega^+} \left( \Convection \cdot \Vektor{n} \right) u w ~ d \sigma(\Vektor{x}) - \int_{\Omega} u \Divergence \left( \Convection w \right) ~ d \omega(\Vektor{x}) \notag \\
        &+ \int_{\Omega} \Reaction u w ~ d \omega(\Vektor{x}) = \int_{\Omega} g w ~ d \omega(\Vektor{x}) + \int_{\partial \Omega^+} u_N w ~ d \sigma(\Vektor{x}),
    \end{align}
    for all $w \in V$.
\end{definition}
This weak formulation is derived by multiplying \cref{equation:cdr} by any $w \in V$, applying Green's theorem and using \cref{equation:cdr_neumann}. % [!] Expand.

Under the following regularity assumptions:
\begin{align}
    \partial_t u & \in \SpaceLp{1}(I; \SpaceHk{p + 1}(\Omega)), \label{equation:assumption_regularity_1} \\
    u & \in \SpaceLp{1}(I; \SpaceHk{p + 1}(\Omega)) \cap \SpaceLp{2}(I; \SpaceHk{p + 1}(\Omega)), \label{equation:assumption_regularity_2}
\end{align}
it is possible to show that there exists a unique weak solution $u$ satisfying \cref{equation:cdr} pointwise, with $u \in C^0(\left[ 0, T \right); \SpaceHk{p + 1}(\Omega))$, where $p \geq 1$ is an integer denoting the spatial degree of approximation. Furthermore, if $\Diffusion > 0$, it can be shown that $\partial_t u \in \SpaceLp{2}(I \times \Omega)$.

\newpage
\section{Discretization} \label{sec:cdr_discretization}

\subsection{Space Discretization Setting}

For the semi-discretization in space of this problem, consider $\left\{ \SpaceMesh \right\}_{h \in \hIndices}$ to be a family of standard, conforming triangulations of $\Omega$, each consisting of closed $d$-simplices $K_j$ indexed by $j \in \SpaceIndices$, and referred to as $K$ when unambiguous. % [!] d (Dimension).

If $K_i \cap K_j \neq \emptyset$, except for a single point, i.e., a vertex, define $\Gamma_{ij} = K_i \cap K_j$ for $i, j \in \SpaceIndices$, and refer to $K_i$ and $K_j$ as neighbors. Moreover, define:
\begin{align}
    \Neighbours{i} = \left\{ j \in \SpaceIndices \text{ such that } K_j \text{ is a neighbour of } K_i \right\} &\text{ for all } i \in \SpaceIndices.
\end{align}

Furthermore, for $K \in \Omega_h$, introduce $h_K$ and $\rho_K$ as the diameter of $K$ and the diameter of the largest ball inscribed in $K$, respectively. Define, then:
\begin{align}
    h = \max_{K \in \Omega_h} \left\{ h_K \right\}.
\end{align}

Assume that all triangulations are shape-regular, that is there exists $\BoundC{h} > 0$ such that:
\begin{align}
    \frac{h_K}{\rho_K} &\leq \BoundC{h} &\text{ for all } K \in \Omega_h &\text{ and for all } h \in \hIndices.
\end{align}
It can also be assumed that this constant is independent of $h$ and remains the same for all triangulations $\Omega_h$.

Consider now the broken Sobolev space.
\begin{definition}[$\SpaceHk{k}(\Omega, \Omega_h)$] % [!] Check v, break.
    Let $k \geq 1$ integer, then:
    \begin{align}
        \SpaceHk{k}(\Omega, \Omega_h) = \left\{ v \in \SpaceLp{2}(\Omega) \text{ such that } v \Restriction_{K} \in \SpaceHk{k}(K) \text{ for all } K \in \Omega_h \right\}.
    \end{align}
    Moreover, $\SpaceHk{k}(\Omega, \Omega_h)$ is equipped with the seminorm $\left\lvert \cdot \right\rvert_{\SpaceHk{k}(\Omega, \Omega_h)}$, such that for all \\ $v \in \SpaceHk{k}(\Omega, \Omega_h)$:
    \begin{align}
        \left\lvert v \right\rvert_{\SpaceHk{k}(\Omega, \Omega_h)}^2 = \sum_{K \in \Omega_h} \left\lvert v \right\rvert_{\SpaceHk{k}(K)}^2.
    \end{align}
\end{definition}

For $v \in \SpaceHk{1}(\Omega, \Omega_h)$, $v \Restriction_{\Gamma_{ij}}$ corresponds to the trace of $v \Restriction_{K_i}$ on $\Gamma_{ij}$ while $v \Restriction_{\Gamma_{ji}}$ corresponds to the trace of $v \Restriction_{K_j}$ on $\Gamma_{ji}$. Moreover:
\begin{align}
    \langle v \rangle_{\Gamma_{ij}} &= \frac{1}{2} \left( v \Restriction_{\Gamma_{ij}} + v \Restriction_{\Gamma_{ji}} \right), \\
    \left[ v \right]_{\Gamma_{ij}} &= v \Restriction_{\Gamma_{ij}} - v \Restriction_{\Gamma_{ji}},
\end{align}
and $\Vektor{n}_{ij}$ denotes the unit outer normal with respect to $\partial K_i$ on $\Gamma_{ij}$. Note that, geometrically, $\Gamma_{ji} = \Gamma_{ij}$.

Finally, for $i \in \SpaceIndices$:
\begin{align}
    \partial K_i^-(t) = \left\{ \Vektor{x} \in \partial K_i \text{ such that } \Convection(t, \Vektor{x}) \cdot \Vektor{n}_i(\Vektor{x}) < 0 \right\}, \\
    \partial K_i^+(t) = \left\{ \Vektor{x} \in \partial K_i \text{ such that } \Convection(t, \Vektor{x}) \cdot \Vektor{n}_i(\Vektor{x}) \geq 0 \right\},
\end{align}
namely the inflow and outflow parts of $\partial K_i$, where $\Vektor{n}_i$ denotes the unit outer normal with respect to $\partial K_i$.

The dependence of $\partial K_i^-(t)$ and $\partial K_i^+(t)$ on $t$ will be implicit in what follows.

\newpage
\subsection{Discontinuous Galërkin Semi-Discretization in Space} \label{sec:space_discretization}

Under assumptions \cref{equation:assumption_regularity_1,equation:assumption_regularity_2}, the exact solution $u$ satisfies what follows for all $w \in \SpaceHk{2}(\Omega, \Omega_h)$ and for a.e. $t \in I$:
\begin{align}
    \left( \partial_t u(t), w \right)_0 &+ A_h(u(t), w) = l_h \left( w \right) (t),
\end{align}
where:
\begin{align}
    A_h(u, w) = a_h \left( u(t), w \right) + b_h \left( u(t), w \right) + c_h \left( u(t), w \right) + \Diffusion J^{\kappa}_h \left( u(t), w \right) \label{equation:cdr_Ah},
\end{align}
and:
\begin{align}
    a_h \left( u, w \right) &= \Diffusion \sum_{i \in \SpaceIndices} \int_{K_i} \Gradient u \cdot \Gradient w ~ d \omega(\Vektor{x}) \label{equation:cdr_ah} \\
    &- \Diffusion \sum_{i \in \SpaceIndices} \sum_{\substack{j \in \Neighbours{i} \\ j < i}} \int_{\Gamma_{ij}} \left( \left\langle \Gradient u \right\rangle \cdot \Vektor{n}_{ij} \left[ w \right] - \left\langle \Gradient w \right\rangle \cdot \Vektor{n}_{ij} \left[ u \right] \right) ~ d \sigma(\Vektor{x}) \notag \\
    &- \Diffusion \sum_{i \in \SpaceIndices} \int_{\partial K_i^- \cap \partial \Omega} \left( \left( \Gradient u \cdot \Vektor{n}_i \right) w - \left( \Gradient w \cdot \Vektor{n}_i \right) u \right) ~ d \sigma(\Vektor{x}), \notag \\
    b_h \left( u, w \right) &= \sum_{i \in \SpaceIndices} \int_{K_i} \left( \Convection \cdot \Gradient u \right) w ~ d \omega(\Vektor{x}) \label{equation:cdr_bh} - \sum_{i \in \SpaceIndices} \int_{\partial K_i^- \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) \left[ u \right] w ~ d \sigma(\Vektor{x}) \\
    &- \sum_{i \in \SpaceIndices} \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u w ~ d \sigma(\Vektor{x}), \notag \\
    c_h \left( u, w \right) &= \int_{\Omega} \Reaction u w ~ d \omega(\Vektor{x}), \label{equation:cdr_ch} \\
    J^{\kappa}_h \left( u, w \right) &= \sum_{i \in \SpaceIndices} \sum_{j \in \Neighbours{i}} \int_{\Gamma_{ij}} \kappa \left[ u \right] \left[ w \right] ~ d \sigma(\Vektor{x}) + \sum_{i \in \SpaceIndices} \int_{\partial K_i^- \cap \partial \Omega} \kappa u w ~ d \sigma(\Vektor{x}), \label{equation:cdr_jh} \\
    l_h \left( w \right)  &= \left( g, w \right)_0 + \sum_{i \in \SpaceIndices} \int_{\partial K_i^+ \cap \partial \Omega} u_N w ~ d \sigma(\Vektor{x}) \label{equation:cdr_lh} \\
    &+ \Diffusion \sum_{i \in \SpaceIndices} \int_{\partial K_i^- \cap \partial \Omega} \kappa u_D w ~ d \sigma(\Vektor{x}) + \Diffusion \sum_{i \in \SpaceIndices} \int_{\partial K_i^- \cap \partial \Omega} u_D \left( \Gradient w \cdot \Vektor{n}_i \right) ~ d \sigma(\Vektor{x}) \notag \\
    &- \sum_{i \in \SpaceIndices} \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u_D w ~ d \sigma(\Vektor{x}) \notag,
\end{align}
with:
\begin{align}
    \kappa \Restriction_{\Gamma_{ij}} = \left( \Diameter \Gamma_{ij} \right)^{-1}.
\end{align}

This formulation is derived by multiplying \cref{equation:cdr} by any $w \in \SpaceHk{2}(\Omega, \Omega_h)$, integrating over each $K \in \Omega_h$, applying Green's theorem, summing over all $K \in \Omega_h$, adding terms that either appear on both sides or vanish, and using \cref{equation:cdr_dirichlet} and \cref{equation:cdr_neumann}. More details can be found in the following sections.

\newpage
\subsubsection{Diffusion Term Discretization}

The bilinear form $a_h$ represents the discretization of the diffusion term in the nonsymmetric formulation, which guarantees its non-negativity. Green's theorem is used and the following terms are added:
\begin{align}
    \int_{\Gamma_{ij}} \left\langle \Gradient w \right\rangle \cdot \Vektor{n}_{ij} \left[ u \right] ~ d \sigma(\Vektor{x}),
\end{align}
which vanish under assumptions \cref{equation:assumption_regularity_1} and \cref{equation:assumption_regularity_2} as $\left[ u \right]_{\Gamma_{ij}} = 0$ for all $i \in \SpaceIndices$ and for all $j \in \Neighbours{i}$. Note that, due to $\left\langle \Gradient u \right\rangle_{\Gamma_{ij}} = \Gradient u \Restriction_{\Gamma{ij}} = \Gradient u \Restriction_{\Gamma{ji}}$ for all $i \in \SpaceIndices$ and for all $j \in \Neighbours{i}$, the following terms:
\begin{align}
    \sum_{\substack{j \in \Neighbours{i} \\ j < i}} \int_{\Gamma_{ij}} \left\langle \Gradient u \right\rangle \cdot \Vektor{n}_{ij} \left[ w \right] ~ d \sigma(\Vektor{x}),
\end{align}
represent the sum of integrals of $w \partial_{\Vektor{n}} u$ over faces of $\partial K_i$ in $\Omega$ for all $i \in \SpaceIndices$. Finally, the remaining integrals are represented by the following terms:
\begin{align}
    \int_{\partial K_i^- \cap \partial \Omega} \left( \left( \Gradient u \cdot \Vektor{n}_i \right) w - \left( \Gradient w \cdot \Vektor{n}_i \right) u \right) ~ d \sigma(\Vektor{x}),
\end{align}
for which the second part cancels with the corresponding terms in $l_h$ as $u = u_D$ on $\partial \Omega^-$, and by the following terms:
\begin{align}
    \int_{\partial K_i^+ \cap \partial \Omega} u_N w ~ d \sigma(\Vektor{x}),
\end{align}
which appear in $l_h$ due to \cref{equation:cdr_neumann}.

\newpage
\subsubsection{Convection Term Discretization}

The bilinear form $b_h$ represents the discretization of the convection term. Applying Green's theorem yields, for $i \in \SpaceIndices$:
\begin{align}
    \int_{K_i} \left( \Convection \cdot \Gradient u \right) w ~ d \omega(\Vektor{x}) &= \int_{\partial K_i} \left( \Convection \cdot \Vektor{n}_i \right) u w ~ d \sigma(\Vektor{x}) - \int_{K_i} u \Divergence \left( \Convection w \right) ~ d \omega(\Vektor{x}) \notag \\
    &= \int_{\partial K_i^-} \left( \Convection \cdot \Vektor{n}_i \right) u w ~ d \sigma(\Vektor{x}) + \int_{\partial K_i^+} \left( \Convection \cdot \Vektor{n}_i \right) u w ~ d \sigma(\Vektor{x}) \label{equation:cdr_convection_discretization_1} \\
    & - \int_{K_i} u \Divergence \left( \Convection w \right) ~ d \omega(\Vektor{x}). \notag
\end{align}
Consider, on the inflow part of $\partial K_i$, the ``information coming from outside'' the element $K_i$, that is, write $u^-$ instead of $u$, where $u^-$ is a simplified notation for $u \Restriction_{\Gamma_{ji}}$ for all $j \in \Neighbours{i}$. Additionally, consider $u^- = u_D$ on $\partial K_i^- \cap \partial \Omega$. Starting from \cref{equation:cdr_convection_discretization_1}, further rearrange the resulting terms:
\begin{align}
    \int_{K_i} \left( \Convection \cdot \Gradient u \right) w ~ d \omega(\Vektor{x}) &= \int_{\partial K_i^-} \left( \Convection \cdot \Vektor{n}_i \right) u^- w ~ d \sigma(\Vektor{x}) + \int_{\partial K_i^+} \left( \Convection \cdot \Vektor{n}_i \right) u w ~ d \sigma(\Vektor{x}) \notag \\
    &- \int_{K_i} u \Divergence \left( \Convection w \right) ~ d \omega(\Vektor{x}) \notag \\
    &= - \int_{K_i} u \Divergence \left( \Convection w \right) ~ d \omega(\Vektor{x}) \pm \int_{\partial K_i} \left( \Convection \cdot \Vektor{n}_i \right) u w ~ d \sigma(\Vektor{x}) \notag \\
    &+ \int_{\partial K_i^- \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u^- w ~ d \sigma(\Vektor{x}) + \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u^- w ~ d \sigma(\Vektor{x}) \notag \\
    &+ \int_{\partial K_i^+ \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u w ~ d \sigma(\Vektor{x}) + \int_{\partial K_i^+ \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u w ~ d \sigma(\Vektor{x}) \notag \\
    &= \int_{K_i} \left( \Convection \cdot \Gradient u \right) w ~ d \omega(\Vektor{x}) + \int_{\partial K_i^- \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) \left( u^- - u \right) w ~ d \sigma(\Vektor{x}) \notag \\
    &- \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u w ~ d \sigma(\Vektor{x}) + \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u^- w ~ d \sigma(\Vektor{x}) \notag \\
    &= \int_{K_i} \left( \Convection \cdot \Gradient u \right) w ~ d \omega(\Vektor{x}) - \int_{\partial K_i^- \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) \left[ u \right] w ~ d \sigma(\Vektor{x}) \\
    &- \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u w ~ d \sigma(\Vektor{x}) + \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u_D w ~ d \sigma(\Vektor{x}). \notag
\end{align}
Note that the last term is transferred to $l_h$ while the other terms define $b_h$ as in \cref{equation:cdr_bh}.

\newpage
\subsubsection{Interior and Boundary Penalty}

The bilinear form $J^{\kappa}_h$ represents the interior and boundary penalty that replaces the continuity of conforming finite elements. The first term vanishes due to \cref{equation:assumption_regularity_1} and \cref{equation:assumption_regularity_2}, while the second term cancels with the corresponding term in $l_h$.

\subsubsection{Approximate Solution}

\begin{definition}[$\SpaceSolution_h^p$]
    \begin{align}
        \SpaceSolution_h^p = \left\{ v \in \SpaceLp{2}(\Omega) \text{ such that } u \Restriction_{K} \in \SpacePolynomials{p}(K) \text{ for all } K \in \Omega_h \right\}.
    \end{align}
\end{definition}

The discontinuous Galërkin semi-discrete problem is to find an approximate solution $u_h \in C^1(I; \SpaceSolution_h^p)$ to \cref{equation:cdr} with the initial-boundary conditions \cref{equation:cdr_dirichlet,equation:cdr_neumann,equation:cdr_initial}, such that:
\begin{align}
    \left( \partial_t u_h(t), w_h \right)_0 + A_h(u_h(t), w_h) &= l_h(w_h) &\text{ for all } w_h \in \SpaceSolution_h^p \text{ and for all } t \in I, \\
    \left( u_h(0), w_h \right)_0 &= \left( u_0, w_h \right)_0 &\text{ for all } w_h \in \SpaceSolution_h^p.
\end{align}

\newpage
\subsection{Time Discretization Setting}

Following \cite{Feistauer2007}, for the discretization in time of this problem, consider $\left\{ I_{\tau} \right\}_{\tau \in \tIndices}$ to be a family of partitions of $\overline{I}$, each consisting of intervals $I_n$ indexed by $n \in \TimeIndices = \left\{ 1, \dots, \nTimeIndices \right\}$. A partition $I_{\tau}$ is such that:
\begin{align}
    I_{\tau} &= \left\{ 0 = t_0 < t_1 < \dots < t_{N_\tau} = T \right\} &\text{ for all } \tau \in \tIndices.
\end{align}
Moreover, denote by $I_n = \left( t_{n - 1}, t_n \right)$ and $\overline{I}_n = \left[ t_{n - 1}, t_n \right]$ so that:
\begin{align}
    \overline{I} &= \left[ 0, T \right] = \bigcup_{n \in \TimeIndices} \overline{I}_n &\text{ for all } \tau \in \tIndices,
\end{align}
and:
\begin{align}
    I_n \cap I_m = \emptyset &\text{ for all } n, m \in \TimeIndices \text{ such that } n \neq m \text{ and for all } \tau \in \tIndices.
\end{align}

For a function $v$ defined on:
\begin{align}
    \bigcup_{n \in \TimeIndices} I_n,
\end{align}
consider the following notations:
\begin{align} % [!] Check \varepsilon.
    u_n^+ &= v(t_n^+) = \lim_{\varepsilon \rightarrow 0} v(t_n^+ + \varepsilon) &\text{ for all } n \in \TimeIndices, \\
    u_n^- &= v(t_n^-) = \lim_{\varepsilon \rightarrow 0} v(t_n^- + \varepsilon) &\text{ for all } n \in \TimeIndices, \\
    \Jump{v}_n &= u_n^+ - u_n^- &\text{ for all } n \in \TimeIndices.
\end{align}

Consider, in general, different families of triangulations on each $I_n$ for $n \in \TimeIndices$, that is, consider distinct $\SpaceTimeIndices$ and $\hTimeIndices$ for all $n \in \TimeIndices$, so that $\left\{ \Omega_{h, n} \right\}_{h \in \hTimeIndices}$ is the family of triangulations of $\Omega$ associated with $n \in \TimeIndices$ for all $\tau \in \tIndices$.

Furthermore, set:
\begin{align}
    h_n &= \max_{K \in \Omega_{h, n}} \left\{ h_K \right\} &\text{ for all } n \in \TimeIndices, \\
    h &= \max_{n \in \TimeIndices} \left\{ h_n \right\}, \\
    \tau &= \max_{n \in \TimeIndices} \left\{ \lambda(I_n) \right\} = \max_{n \in \TimeIndices} \left\{ t_n - t_{n - 1} \right\}.
\end{align}

\newpage
\subsection{Discontinuous Galërkin Discretization in Time} \label{sec:full_discretization}

Considering different families of triangulations on each $I_n$ leads to the following modification of $\SpaceSolution_h^p$:
\begin{definition}[$\SpaceSolution_{h, n}^p$]
    \begin{align}
        \SpaceSolution_{h, n}^p = \left\{ v \in \SpaceLp{2}(\Omega) \text{ such that } v \Restriction_{K} \in \SpacePolynomials{p}(K) \text{ for all } K \in \Omega_{h, n} \right\}.
    \end{align}
\end{definition}

Moreover, the bilinear forms $a_h$, $b_h$, $c_h$, and $J^{\kappa}_h$, as well as $l_h$, introduced in \Cref{sec:space_discretization}, are redefined as follows:
\begin{align}
    a_{h, n} \left( u, w \right) &= \Diffusion \sum_{i \in \SpaceTimeIndices} \int_{K_i} \Gradient u \cdot \Gradient w ~ d \omega(\Vektor{x}) \label{equation:cdr_ahn} \\
    &- \Diffusion \sum_{i \in \SpaceTimeIndices} \sum_{\substack{j \in \NeighboursTime{i} \\ j < i}} \int_{\Gamma_{ij}} \left( \left\langle \Gradient u \right\rangle \cdot \Vektor{n}_{ij} \left[ w \right] - \left\langle \Gradient w \right\rangle \cdot \Vektor{n}_{ij} \left[ u \right] \right) ~ d \sigma(\Vektor{x}) \notag \\
    &- \Diffusion \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \cap \partial \Omega} \left( \left( \Gradient u \cdot \Vektor{n}_i \right) w - \left( \Gradient w \cdot \Vektor{n}_i \right) u \right) ~ d \sigma(\Vektor{x}), \notag \\
    b_{h, n} \left( u, w \right) &= \sum_{i \in \SpaceTimeIndices} \int_{K_i} \left( \Convection \cdot \Gradient u \right) w ~ d \omega(\Vektor{x}) \label{equation:cdr_bhn} - \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) \left[ u \right] w ~ d \sigma(\Vektor{x}) \\
    &- \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u w ~ d \sigma(\Vektor{x}), \notag \\
    c_{h, n} \left( u, w \right) &= \int_{\Omega} \Reaction u w ~ d \omega(\Vektor{x}), \label{equation:cdr_chn} \\
    J^{\kappa}_{h, n} \left( u, w \right) &= \sum_{i \in \SpaceTimeIndices} \sum_{j \in \NeighboursTime{i}} \int_{\Gamma_{ij}} \kappa \left[ u \right] \left[ w \right] ~ d \sigma(\Vektor{x}) + \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \cap \partial \Omega} \kappa u w ~ d \sigma(\Vektor{x}), \label{equation:cdr_jhn} \\
    l_{h, n} \left( w \right)  &= \left( g, w \right)_0 + \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^+ \cap \partial \Omega} u_N w ~ d \sigma(\Vektor{x}) \label{equation:cdr_lhn} \\
    &+ \Diffusion \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \cap \partial \Omega} \kappa u_D w ~ d \sigma(\Vektor{x}) + \Diffusion \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \cap \partial \Omega} u_D \left( \Gradient w \cdot \Vektor{n}_i \right) ~ d \sigma(\Vektor{x}) \notag \\
    &- \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) u_D w ~ d \sigma(\Vektor{x}) \notag,
\end{align}
where:
\begin{align}
    \NeighboursTime{i} = \left\{ j \in \SpaceTimeIndices \text{ such that } K_j \text{ is a neighbour of } K_i \right\},
\end{align}
for all $i \in \SpaceTimeIndices$ and for all $n \in \TimeIndices$.

Set, then:
\begin{align}
    A_{h, n}(u, w) = a_{h, n} \left( u(t), w \right) + b_{h, n} \left( u(t), w \right) + c_{h, n} \left( u(t), w \right) + \Diffusion J^{\kappa}_{h, n} \left( u(t), w \right) \label{equation:cdr_Ahn}.
\end{align}

Note that this is essentially the same definition given in \Cref{sec:space_discretization}, with the modification that it accounts for the change in the spatial mesh at each time interval.

\newpage
\subsubsection{Approximate Solution}

\begin{definition}[$\SpaceSolutionFull$]
    Let $q \geq 1$ be an integer, then:
    \begin{align} % [!] To be fixed.
        \SpaceSolutionFull = \left\{ v \in \SpaceLp{2}(I \times \Omega) \text{ such that } v \Restriction_{I_n} = \sum_{i = 0}^q t^i u_i, \right. \\ 
        \left. \vphantom{\sum_{i = 0}^q} \text{ where } \left\{ u_i \right\}_{i = 0}^q \subset \SpaceSolution_{h, n}^p \text{ for all } n \in \TimeIndices \right\}.
    \end{align}
\end{definition}

The discontinuous Galërkin discrete problem is to find an approximate solution $u_{h, \tau} \in \SpaceSolutionFull$ to \cref{equation:cdr} with the initial-boundary conditions \cref{equation:cdr_dirichlet,equation:cdr_neumann,equation:cdr_initial}, such that:
\begin{align} % [!] Fix alignment and (?) u(0).
    \sum_{n \in \TimeIndices} \int_{I_n} \left( (\partial_t u_{h, \tau}, w )_0 + A_{h, n}(u_{h, \tau}, w) \right) ~ dt \notag &+ \sum_{n = 2}^{\nTimeIndices} (\left\{ u_{h, \tau} \right\}_{n - 1}, w_{n - 1}^+ )_0 + ((u_{h, \tau})_0^+, w_0^+ )_0 \notag \\
    &= \sum_{n \in \TimeIndices} \int_{I_n} l_{h, n}(w) ~ dt + (u_0, w_0^+ )_0, \label{equation:cdr_discrete}
\end{align}
for all $w \in \SpaceSolutionFull$

By the following notation:
\begin{align}
    B(u, w) &= \sum_{n \in \TimeIndices} \int_{I_n} \left( (\partial_t u, w )_0 + A_{h, n}(u, w) \right) ~ dt + \sum_{n = 2}^{\nTimeIndices} (\Jump{u}_{n - 1}, w_{n - 1}^+ )_0 + (u_0^+, w_0^+ )_0, \label{equation:cdr_B} \\
    L(w) &= \sum_{n \in \TimeIndices} \int_{I_n} l_{h, n}(w) ~ dt + (u_0, w_0^+ )_0 \label{equation:cdr_L},
\end{align}
it is possibile to rewrite \cref{equation:cdr_discrete} as:
\begin{align}
    B(u_{h, \tau}, w) &= L(w) &\text{ for all } w \in \SpaceSolutionFull. \label{equation:cdr_discrete_short}
\end{align}

\newpage
\subsection{Assumptions and Basic Properties}

Assume that all triangulations $\Omega_{h, n}$, for all $h \in \hIndices$ and for all $n \in \TimeIndices$ are shape-regular, that is there exists $\BoundC{\tau} > 0$ such that, for all $\tau \in \tIndices$:
\begin{align}
    \frac{h_K}{\rho_K} &\leq \BoundC{\tau} &\text{ for all } K \in \Omega_{h, n} \text{ and for all } n \in \TimeIndices. \label{equation:ass_h}
&\end{align}
Moreover, assume that there exists $\BoundDeg > 0$ such that:
\begin{align}
    h_{K_i} &\leq \BoundDeg \Diameter \Gamma_{ij} &\text{ for all } i \in \SpaceTimeIndices, j \in \NeighboursTime{i} \text{ and for all } n \in \TimeIndices. \label{equation:ass_hd}
\end{align}
This implies the non-degeneracy of $\left\{ \Gamma_{ij} \right\}_{j \in \NeighboursTime{i}}$ with respect to $h_{K_i}$ as $h_{K_i}$ becomes small.

From \cite{Dolejší2002} and \cite{Ciarlet1978}, consider the following two inequalities:

\begin{lemma}[Multiplicative trace inequality]
    There exists $\BoundTrace > 0$ such that:
    \begin{align}
        \left\lVert v \right\rVert_{\SpaceLp{2}(\partial K)}^2 \leq \BoundTrace \left( \left\lVert v \right\rVert_{\SpaceLp{2}(K)} \left\lvert v \right\rvert_{\SpaceHk{1}(K)} + h_K^{-1} \left\lVert v \right\rVert_{\SpaceLp{2}(K)}^2 \right),
    \end{align}
    for all $v \in \SpaceHk{1}(K)$, for all $K \in \Omega_{h, n}$, for all $h \in \hIndices$, and for all $n \in \TimeIndices$.
\end{lemma}

\begin{lemma}[Inverse inequality]
    There exists $\BoundInverse > 0$ such that:
    \begin{align}
        \left\lvert v \right\rvert_{\SpaceHk{1}(K)} \leq \BoundInverse h_K^{-1} \left\lVert v \right\rVert_{\SpaceLp{2}(K)},
    \end{align}
    for all $v \in \SpaceSolution^p_{h, n}$, for all $K \in \Omega_{h, n}$, for all $h \in \hIndices$, and for all $n \in \TimeIndices$.
\end{lemma}

For what follows, fix the following notations:
\begin{align} % [!] To be renamed.
    \left\lVert w \right\rVert_{T}^2 &= \frac{1}{2} \left\lVert u_0^+ \right\rVert_{\SpaceLp{2}(\Omega)}^2 + \frac{1}{2} \sum_{n = 1}^{\nTimeIndices - 1} \left\lVert \Jump{w}_n \right\rVert_{\SpaceLp{2}(\Omega)}^2 + \frac{1}{2} \left\lVert u_{\nTimeIndices}^+ \right\rVert_{\SpaceLp{2}(\Omega)}^2, \\
    \left\lVert w \right\rVert_{E, n}^2 &= \Diffusion \left\lvert w \right\rvert_{\SpaceHk{1}(\Omega, \Omega_{h, n})}^2 + \BoundC{\Reaction \Convection} \left\lVert w \right\rVert_{\SpaceLp{2}(\Omega)}^2 + \Diffusion J^{\kappa}_{h, n}(w, w) \\
    &+ \frac{1}{2} \sum_{i \in \SpaceTimeIndices} \left( \left\lVert w \right\rVert_{\Convection, \partial K_i \cap \partial \Omega}^2 + \left\lVert w \right\rVert_{\Convection, \partial K_i^- \setminus \partial \Omega}^2 \right), \notag
\end{align}
where:
\begin{align}
    \left\lVert w \right\rVert_{\Convection, \Gamma}^2 &= \int_{\Gamma} \left\lvert \Convection \cdot \Vektor{n} \right\rvert w^2 ~ d \sigma(\Vektor{x}) &\text{ for all } K \in \Omega_{h, n} \text{ where } \Gamma \subset \partial K.
\end{align}

Consider, then, the following basic properties of the bilinear forms $A_{h, n}$ and $B$:

\begin{lemma}[Coercivity of $A_{h, n}$] \label{lemma:A_coercivity}
    The forms $A_{h, n}$ are coercive, that is:
    \begin{align}
        A_{h, n}(w, w) &\geq \left\lVert w \right\rVert_{E, n}^2 &\text{ for all } w \in \SpaceHk{1}(\Omega, \Omega_{h, n}).
    \end{align}
\end{lemma}

\begin{proof}
    By \cref{equation:cdr_ahn}:
    \begin{align*}
        a_{h, n} \left( w, w \right) &= \Diffusion \sum_{i \in \SpaceTimeIndices} \int_{K_i} \Gradient w \cdot \Gradient w ~ d \omega(\Vektor{x}) \\
        &- \Diffusion \sum_{i \in \SpaceTimeIndices} \sum_{\substack{j \in \NeighboursTime{i} \\ j < i}} \int_{\Gamma_{ij}} \left( \left\langle \Gradient w \right\rangle \cdot \Vektor{n}_{ij} \left[ w \right] - \left\langle \Gradient w \right\rangle \cdot \Vektor{n}_{ij} \left[ w \right] \right) ~ d \sigma(\Vektor{x}) \\
        &- \Diffusion \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \cap \partial \Omega} \left( \left( \Gradient w \cdot \Vektor{n}_i \right) w - \left( \Gradient w \cdot \Vektor{n}_i \right) w \right) ~ d \sigma(\Vektor{x}) \\
        &= \Diffusion \sum_{i \in \SpaceTimeIndices} \int_{K_i} \Gradient w \cdot \Gradient w ~ d \omega(\Vektor{x}) \\
        &= \Diffusion \Seminorm{w}_{\SpaceHk{1}(\Omega, \Omega_{h, n})}^2.
    \end{align*}

    By \cref{equation:cdr_bhn}:
    \begin{align*}
        b_{h, n} \left( w, w \right) &= \sum_{i \in \SpaceTimeIndices} \int_{K_i} \left( \Convection \cdot \Gradient w \right) w ~ d \omega(\Vektor{x}) - \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) \left[ w \right] w ~ d \sigma(\Vektor{x}) \\
        &- \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) w^2 ~ d \sigma(\Vektor{x}) \\
        &= - \frac12 \sum_{i \in \SpaceTimeIndices} \int_{K_i} \Divergence{\Convection} w^2 ~ d \omega(\Vektor{x}) + \frac12 \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i} \left( \Convection \cdot \Vektor{n}_i \right) w^2 ~ d \sigma(\Vektor{x}) \\
        &- \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) w^2 ~ d \sigma(\Vektor{x}) \\
        &- \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) \left( w - w^- \right) w ~ d \sigma(\Vektor{x}),
    \end{align*}
    and, by $\partial K_i = \partial K_i^- \cup \partial K_i^+$:
    \begin{align*}
        b_{h, n} \left( w, w \right) &= - \frac12 \sum_{i \in \SpaceTimeIndices} \int_{K_i} \Divergence{\Convection} w^2 ~ d \omega(\Vektor{x}) - \frac12 \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) w^2 ~ d \sigma(\Vektor{x}) \\
        &- \frac12 \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) \left( w^2 - 2 ww^- \right) ~ d \sigma(\Vektor{x}) \\
        &+ \frac12 \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^+ \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) w^2 ~ d \sigma(\Vektor{x}) + \frac12 \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^+ \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) w^2 ~ d \sigma(\Vektor{x}),
    \end{align*}
    hence, by using:
    \begin{align*}
        \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^+ \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) w^2 ~ d \sigma(\Vektor{x}) = - \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) \left( w^- \right)^2 ~ d \sigma(\Vektor{x}),
    \end{align*}
    it follows that:
    \begin{align*}
        b_{h, n} \left( w, w \right) &= - \frac12 \sum_{i \in \SpaceTimeIndices} \int_{K_i} \Divergence{\Convection} w^2 ~ d \omega(\Vektor{x}) - \frac12 \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) w^2 ~ d \sigma(\Vektor{x}) \\
        &- \frac12 \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^- \setminus \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) \left( w^2 - 2 ww^- + \left( w^- \right)^2 \right) ~ d \sigma(\Vektor{x}) \\
        &+ \sum_{i \in \SpaceTimeIndices} \int_{\partial K_i^+ \cap \partial \Omega} \left( \Convection \cdot \Vektor{n}_i \right) w^2 ~ d \sigma(\Vektor{x}) \\
        &= - \frac12 \int_{\Omega} \Divergence{\Convection} w^2 ~ d \omega(\Vektor{x}) \\
        &+ \frac12 \sum_{i \in \SpaceTimeIndices} \left( \Norm{ w }_{\Convection, \partial K_i^- \cap \partial \Omega}^2 + \Norm{ w }_{\Convection, \partial K_i^+ \cap \partial \Omega}^2 + \Norm{ w }_{\Convection, \partial K_i^- \setminus \partial \Omega}^2 \right) \\
        &= - \frac12 \int_{\Omega} \Divergence{\Convection} w^2 ~ d \omega(\Vektor{x}) + \frac12 \sum_{i \in \SpaceTimeIndices} \left( \Norm{ w }_{\Convection, \partial K_i \cap \partial \Omega}^2 + \Norm{ w }_{\Convection, \partial K_i^- \setminus \partial \Omega}^2 \right).
    \end{align*}

    By \cref{equation:cdr_chn}:
    \begin{align*}
        c_{h, n} \left( u, w \right) &= \int_{\Omega} \Reaction w^2 ~ d \omega(\Vektor{x}).
    \end{align*}

    Finally, by \cref{equation:cdr_Ahn}, together with \cref{equation:ass_9}:
    \begin{align*}
        A_{h, n}(w, w) &= a_{h, n} \left( w, w \right) + b_{h, n} \left( w, w \right) + c_{h, n} \left( w, w \right) + \Diffusion J^{\kappa}_{h, n} \left( w, w \right) \\
        &= \Diffusion \Seminorm{w}_{\SpaceHk{1}(\Omega, \Omega_{h, n})}^2 + \int_{\Omega} \left( \Reaction - \frac12 \Divergence{\Convection} \right) w^2 ~ d \omega(\Vektor{x}) + \Diffusion J^{\kappa}_{h, n} \left( w, w \right) \\
        &+ \frac12 \sum_{i \in \SpaceTimeIndices} \left( \Norm{ w }_{\Convection, \partial K_i \cap \partial \Omega}^2 + \Norm{ w }_{\Convection, \partial K_i^- \setminus \partial \Omega}^2 \right) \\
        &\geq \Diffusion \left\lvert w \right\rvert_{\SpaceHk{1}(\Omega, \Omega_{h, n})}^2 + \BoundC{\Reaction \Convection} \left\lVert w \right\rVert_{\SpaceLp{2}(\Omega)}^2 + \Diffusion J^{\kappa}_{h, n}(w, w) \\
        &+ \frac{1}{2} \sum_{i \in \SpaceTimeIndices} \left( \left\lVert w \right\rVert_{\Convection, \partial K_i \cap \partial \Omega}^2 + \left\lVert w \right\rVert_{\Convection, \partial K_i^- \setminus \partial \Omega}^2 \right) \\
        &= \left\lVert w \right\rVert_{E, n}^2.
    \end{align*}
\end{proof}

\begin{lemma}[Reformulation of $B$]
    \Cref{equation:cdr_B} can be reformulated to:
    \begin{align}
        B(u, w) = \sum_{n \in \TimeIndices} \int_{I_n} \left( (-u, \partial_t w )_0 + A_{h, n}(u, w) \right) ~ dt - \sum_{n = 1}^{\nTimeIndices - 1} (u_n^-, \Jump{w}_n )_0 + (u_{\nTimeIndices}^-, w_{\nTimeIndices}^-)_0. \label{equation:cdr_B_reformulated}
    \end{align}
\end{lemma}

\begin{proof}
    Integration by parts in \cref{equation:cdr_B} yields:
    \begin{align*}
        \sum_{n \in \TimeIndices} \int_{I_n} (\partial_t u, w )_0 ~ dt &+ \sum_{n = 2}^{\nTimeIndices} (\Jump{u}_{n - 1}, w_{n - 1}^+ )_0 + (u_0^+, w_0^+ )_0 \\
        &= \sum_{n \in \TimeIndices} \int_{I_n} ( -u, \partial_t w )_0 ~ dt + \sum_{n \in \TimeIndices} \left( (u_n^-, w_n^-)_0 - (u_{n - 1}^+, w_{n - 1}^+)_0 \right) \\
        &+ \sum_{n = 2}^{\nTimeIndices} (u_{n - 1}^+ - u_{n - 1}^-, w_{n - 1}^+)_0 + (u_0^+, w_0^+ )_0 \\
        &= \sum_{n \in \TimeIndices} \int_{I_n} ( -u, \partial_t w )_0 ~ dt + \sum_{n = 1}^{\nTimeIndices - 1} (u_n^-, w_n^- - w_n^+)_0 + (u_{\nTimeIndices}^-, w_{\nTimeIndices}^- )_0 \\
        &= \sum_{n \in \TimeIndices} \int_{I_n} (-u, \partial_t w )_0 ~ dt - \sum_{n = 1}^{\nTimeIndices - 1} (u_n^-, \Jump{w}_n )_0 + (u_{\nTimeIndices}^-, w_{\nTimeIndices}^-)_0.
    \end{align*}
\end{proof}

\begin{lemma}[Coercivity of $B$]
    It holds that:
    \begin{align}
        B(w, w) = \sum_{n \in \TimeIndices} \int_{I_n} A_{h, n}(w, w) ~ dt + \left\lVert w \right\rVert_{T}^2,
    \end{align}
    which, together with \Cref{lemma:A_coercivity}, implies coercivity for $B$.
\end{lemma}

\begin{proof}
    By \cref{equation:cdr_B} and \cref{equation:cdr_B_reformulated}, it follows that:
    \begin{align*}
        B(w, w) &= \sum_{n \in \TimeIndices} \int_{I_n} \left( (\partial_t w, w )_0 + A_{h, n}(w, w) \right) ~ dt + \sum_{n = 1}^{\nTimeIndices - 1} (\Jump{w}_n, w_n^+ )_0 + (w_0^+, w_0^+ )_0, \\
        B(w, w) &= \sum_{n \in \TimeIndices} \int_{I_n} \left( (-w, \partial_t w )_0 + A_{h, n}(w, w) \right) ~ dt - \sum_{n = 1}^{\nTimeIndices - 1} (w_n^-, \Jump{w}_n )_0 + (w_{\nTimeIndices}^-, w_{\nTimeIndices}^-)_0.
    \end{align*}

    Then, by summing these two identities and dividing by two:
    \begin{align*}
        B(w, w) &= \sum_{n \in \TimeIndices} \int_{I_n} A_{h, n}(w, w) ~ dt + \frac12 (w_0^+, w_0^+ )_0 + \frac12 (w_{\nTimeIndices}^-, w_{\nTimeIndices}^-)_0 \\
        &+ \frac12 \sum_{n = 1}^{\nTimeIndices - 1} (\Jump{w}_n, \Jump{w}_n )_0 \\
        &= \sum_{n \in \TimeIndices} \int_{I_n} A_{h, n}(w, w) ~ dt + \frac12 \Norm{w_0^+}_{\SpaceLp{2}(\Omega)} + \frac12 \Norm{w_{\nTimeIndices}^-}_{\SpaceLp{2}(\Omega)} \\
        &+ \frac12 \sum_{n = 1}^{\nTimeIndices - 1} \frac12 \Norm{ \Jump{w}_n }_{\SpaceLp{2}(\Omega)} \\
        &= \sum_{n \in \TimeIndices} \int_{I_n} A_{h, n}(w, w) ~ dt + \left\lVert w \right\rVert_{T}^2.
    \end{align*}
\end{proof}

\newpage
\section{Error Analysis} \label{sec:cdr_error_analysis}

\subsection{Abstract Error Estimates} \label{subsection:error_estimates}

In what follows, denote by $u$ the exact solution and by $\AppU$ the approximate solution $u_{h, \tau}$, and denote by $\Error = \AppU - u$ the error of the method.

Furthermore, in what follows, $C$ denotes a generic constant, typically independent of the space and time mesh parameters. Note that different occurrences of $C$ do not necessarily represent the same constant.

For the derivation of error estimates, consider the following space-time interpolation of the exact solution:

\begin{definition}[$\InterpolantPQ$] \label{definition:interpolant_qp}
    $\InterpolantPQ$ is such that:
    \begin{align}
        \InterpolantPQ u &\in \SpaceSolutionFull, \\
        \int_{I_n} \left( \InterpolantPQ u - u, w \right)_0 ~ dt &= 0 &\text{ for all } w \in \SpaceSolutionFullMO, \label{eq:interpolation_result} \\
        \InterpolantPQ u(t_n^-) &= \InterSol u(t_n^-), \label{eq:interpolation_result_2}
    \end{align}
    for all $n \in \TimeIndices$, where $\InterSol$ denotes the $\SpaceLp{2}$ projection in space onto $\SpaceSolution^p_{h, n}$.
\end{definition}

It can be shown that $\InterpolantPQ u$ is uniquely determined by the properties stated in \Cref{definition:interpolant_qp}.

The following identity can then be written involving the $\InterpolantPQ$-interpolation error.

\begin{lemma}
    \begin{align}
        B(\AppU - \InterpolantPQ u, \AppU - \InterpolantPQ u) &= \sum_{n \in \TimeIndices} \int_{I_n} A_{h, n}(u - \InterpolantPQ u, \AppU - \InterpolantPQ u) ~ dt \label{equation:error_1} \\
        &- \sum_{n = 1}^{\nTimeIndices - 1} \left( \left( \InterpolantPQ u - u \right)_n^-, \left\{ \AppU - \InterpolantPQ u \right\}_n \right)_0. \notag
    \end{align}
\end{lemma}

Note that, by using different triangulations on different time levels, $\left\{ \AppU - \InterpolantPQ u \right\}_n \notin \SpaceSolution^p_{h, n}$.

Fix, now, the following notation:
\begin{align}
    \xi &= \AppU - \InterpolantPQ u, \\
    \eta &= \InterpolantPQ u - u,
\end{align}
and note that $\xi \in \SpaceSolutionFull$ and $\eta$ denotes the interpolation error. Observing that $\Error = \xi + \eta$, \cref{equation:error_1} can be rewritten as:
\begin{align}
    B(\xi, \xi) &= - \sum_{n \in \TimeIndices} \int_{I_n} A_{h, n}(\eta, \xi) ~ dt - \sum_{n = 1}^{\nTimeIndices - 1} \left( \eta_n^-, \left\{ \xi \right\}_n \right)_0. \label{equation:error_2}
\end{align}

\begin{definition}[$\theta_n(\eta; h, \Diffusion)$] \label{def:theta}
    Define $\theta_n(\eta; h, \Diffusion)$ as:
    \begin{align} % [!] Check \eta_n^-
        \theta_n(\eta; h, \Diffusion) &= \left\lVert \eta \right\rVert_{E, n} + \sqrt{\Diffusion} h \left\lvert \eta \right\rvert_{\SpaceHk{2}(\Omega, \Omega_{h, n})} \\
        &+ \left( \sum_{i \in \SpaceTimeIndices} h_{K_i}^{-2} \left\lVert \eta \right\rVert_{\SpaceLp{2}(K_i)} \right)^{\nicefrac12} + \left( \sum_{i \in \SpaceTimeIndices} \left\lVert \eta_n^- \right\rVert_{\Convection, \partial K_i^- \setminus \partial \Omega} \right)^{\nicefrac12}
    \end{align}
\end{definition}

\begin{lemma}
    There exists $\ContC{A} > 0$ independent of $u, \AppU, h, \Diffusion$ such that:
    \begin{align}
        \left\lvert A_{h, n}(\eta, \xi) \right\rvert \leq \ContC{A} \left\lVert \xi \right\rVert_{E, n} \theta_n(\eta; h, \Diffusion)
    \end{align}
\end{lemma}

\begin{lemma}
    The following inequality holds:
    \begin{align}
        \sum_{n \in \TimeIndices} \int_{I_n} \left\lVert \xi \right\rVert_{E, n}^2 ~ dt + \left\lVert \xi \right\rVert_T^2 &\leq 4 \ContC{A}^2 \sum_{n \in \TimeIndices} \int_{I_n} \theta_n^2(\eta; h, \Diffusion) ~ dt \\
        &+ 8 \sum_{n = 1}^{\nTimeIndices - 1} \left\lVert \eta_n^- \right\rVert_{\SpaceLp{2}(\Omega)}. \notag
    \end{align}
\end{lemma}

Finally, observing that:
\begin{align}
    \left\lVert \Error \right\rVert_{E, n}^2 &\leq 2 \left( \left\lVert \xi \right\rVert_{E, n}^2 + \left\lVert \eta \right\rVert_{E, n}^2 \right), \\
    \left\lVert \Error \right\rVert_T^2 &\leq 2 \left( \left\lVert \xi \right\rVert_T^2 + \left\lVert \eta \right\rVert_T^2 \right),
\end{align}
which leads to the following abstract error estimate:
\begin{lemma} \label{lemma:abstract_estimates}
    The following holds:
    \begin{align}
        \sum_{n \in \TimeIndices} \int_{I_n} \left\lVert \Error \right\rVert_{E, n}^2 ~ dt + \left\lVert \Error \right\rVert_T^2 &\leq C \sum_{n \in \TimeIndices} \int_{I_n} \theta_n^2(\eta; h, \Diffusion) ~ dt \\
        &+ C \sum_{n = 1}^{\nTimeIndices - 1} \left\lVert \eta_n^- \right\rVert_{\SpaceLp{2}(\Omega)} + \left\lVert \eta \right\rVert_T^2, \notag \\ 
        \sum_{n \in \TimeIndices} \int_{I_n} \left\lVert \Error \right\rVert_{E, n}^2 ~ dt &\leq C \sum_{n \in \TimeIndices} \int_{I_n} \theta_n^2(\eta; h, \Diffusion) ~ dt \label{eq:abstract_estimates_2} \\
        &+ C \sum_{n = 1}^{\nTimeIndices - 1} \left\lVert \eta_n^- \right\rVert_{\SpaceLp{2}(\Omega)}. \notag
    \end{align}
\end{lemma}

% [!!] End of corrections.

\newpage
\subsection{Interpolation Properties}

This section investigates the approximation properties of $\InterpolantPQ$ in order to provide estimates of $\Error$ in terms of $h$ and $\tau$.

\begin{lemma}
    It holds that:
    \begin{align}
        \InterpolantPQ u \Restriction_{I_n} = \InterpolantPQ \left( \InterSol u \right) \Restriction_{I_n}.
    \end{align}
\end{lemma}

\begin{proof}
    Given that $\InterSol$ is the $\SpaceLp{2}$ projection, it follows from \cref{eq:interpolation_result} that:
    \begin{align*}
        \int_{I_n} \left( \InterpolantPQ u - \InterSol u, w \right)_0 ~ dt &= \int_{I_n} \left( \InterpolantPQ u - u, w \right)_0 ~ dt = 0 &\text{ for all } w \in \SpaceSolutionFullMO,
    \end{align*}
    which means that \cref{eq:interpolation_result} is satisfied by $\InterSol u$, while \cref{eq:interpolation_result_2} is satisfied because $\InterSol \left( \InterSol u \right) = \InterSol u$.
\end{proof}

The analysis of approximation properties of $\InterpolantPQ$ with respect to time is based on the transformation of time integrals over $I_n$ to time integrals over $\left( -1, 1 \right)$ with the aid of an affine mapping of $\left( -1, 1 \right)$ onto $I_n$ and the use of Legendre polynomials defined on $\left( -1, 1 \right)$.

\begin{definition}[Legendre polynomials]
    Let $\Legendre$ defined as:
    \begin{align}
        \Legendre_{i}(\zeta) = \frac{2i - 1}{i} \zeta \Legendre_{i - 1}(\zeta) - \frac{i - 1}{i} \Legendre_{i - 2}(\zeta) &\text{ for all } i \in \NaturalNumbers \setminus \left\{ 0, 1 \right\},
    \end{align}
    where:
    \begin{align}
        \Legendre_{0}(\zeta) &= 1, \\
        \Legendre_{1}(\zeta) &= \zeta,
    \end{align}
    be the Legendre polynomials on $\left( -1, 1 \right)$, which form an orthogonal basis in $\SpaceLp{2}(\left( -1, 1 \right))$ and satisfy $\Legendre_i(1) = 1$ for all $i \in \NaturalNumbers$.
\end{definition}

\begin{definition}[$\SpaceSolutionReference$]
    \begin{align}
        \SpaceSolutionReference = \left\{ w \in \SpaceLp{2}(\left( -1, 1 \right) \times \Omega) \text{ such that } w = \sum_{i = 0}^q \zeta^i w_i \text{ with } \left\{ w_i \right\}_{i = 0}^q \subset \SpaceSolution_{h, n}^p \right\}. \label{eq:space_sol_ref_def}
    \end{align}
\end{definition}

Note that $w$ in \cref{eq:space_sol_ref_def} can be expressed more explicitly as:
\begin{align}
    w \left( \zeta, \Vektor{x} \right) = \sum_{i = 0}^q \zeta^i w_i \left( \Vektor{x} \right).
\end{align}

\begin{definition}[$\InterpolantPQR$] \label{definition:interpolant_ref_qp}
    $\InterpolantPQR$ is such that:
    \begin{align}
        \InterpolantPQR w &\in \SpaceSolutionReference, \\
        \int_{-1}^1 \left( \InterpolantPQR w - w, v \right)_0 ~ d \lambda(\zeta) &= 0 &\text{ for all } v \in \SpaceSolutionReferenceMO, \\ 
        \InterpolantPQR w(1^-) &= \InterSol w(1^-),
    \end{align}
    for all $w \in C^0(\left[ -1, 1 \right]; \SpaceLp{2}(\Omega))$ and for all $n \in \TimeIndices$.
\end{definition}

It follows that:
\begin{align}
    \left( \IntU \right) \Restriction_{I_n} = \InterpolantPQI u &\text{ for all } n \in \TimeIndices,
\end{align}
where:
\begin{align}
    \InterpolantPQI u = \left( \InterpolantPQR \left( u \circ \RMap \right) \right) \circ \RMap^{-1},
\end{align}
with $\RMap \colon \left( -1, 1 \right) \rightarrow I_n$ mapping such that:
\begin{align}
    \RMap(\zeta) &= \frac{1}{2}(t_n + t_{n - 1} + \zeta \tau_n) = t &\text{ for all } \zeta \in \left( -1, 1 \right), \\
    \RMap^{-1}(t) &= \frac{1}{\tau_n}(2t - t_n - t_{n - 1}) = \zeta &\text{ for all } t \in I_n.
\end{align}

\begin{lemma} \label{lemma:legendre_interpolant}
    $\InterpolantPQR$ can be expressed with the aid of the Legendre polynomials, so that:
    \begin{align}
        \InterpolantPQR w = \sum_{i = 0}^{q - 1} w_i \Legendre_i + \left( \InterSol w(1^-) - \sum_{i = 0}^{q - 1} w_i \right) \Legendre_q,
    \end{align}
    where:
    \begin{align}
        \InterSol w &= \sum_{i \in \NaturalNumbers} w_i \Legendre_i &\text{ for } \left\{ w_i \right\}_{i \in \NaturalNumbers} \subset \SpaceSolution^p_{h, n},
    \end{align}
    for all $w \in C^0(\left[ -1, 1 \right]; \SpaceLp{2}(\Omega))$ and for all $n \in \TimeIndices$, recalling that $\InterSol$ denotes the $\SpaceLp{2}$ projection in space onto $\SpaceSolution^p_{h, n}$.
\end{lemma}

Set now $\AppUN = \InterSol u \circ \RMap$, then:
\begin{align}
    \eta \Restriction_{I_n} = (\InterpolantPQ u - u) \Restriction_{ I_n} = \InterpolantPQI u \pm \InterSol u - u \Restriction_{I_n} = \InterpolantPQ \InterSol u \pm \InterSol u - u \Restriction_{I_n},
\end{align}
which implies:
\begin{align}
    \left\lVert \eta \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)} & \leq \left\lVert u - \InterSol u \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)} + \left\lVert \InterSol u - \InterpolantPQ \InterSol u \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)} \notag \\
    &= \left\lVert u - \InterSol u \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)} + \left\lVert \InterSol u - \left( \InterpolantPQR \left( \InterSol u \circ \RMap \right) \right) \circ \RMap^{-1} \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)} \notag \\
    &= \left\lVert u - \InterSol u \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)} + \sqrt{\frac{\tau_n}{2}} \left\lVert \AppUN - \InterpolantPQR \AppUN \right\rVert_{\SpaceLp{2}(\left( -1, 1 \right); \SpacePlaceholder)},
\end{align}
where $\SpacePlaceholder$ denotes a Banach space that is yet to be specified.

Moreover, consider the following expansion of $\AppUN$ with respect to the Legendre polynomials:
\begin{align}
    \AppUN &= \sum_{i \in \NaturalNumbers} \AppU_{n, i} \Legendre_i &\text{ for } \left\{ \AppU_{n, i} \right\}_{i \in \NaturalNumbers} \subset \SpaceSolution^p_{h, n}.
\end{align}
Since:
\begin{align}
    \int_{-1}^1 \left( \sum_{i = q + 1}^{+\infty} \AppU_{n, i} \Legendre_i \right) \Legendre_j ~ dt &= 0 &\text{ for all } j \in \left\{ 0, \dots, q \right\},
\end{align}
it follows that:
\begin{align}
    \AppUN - \InterPoly \AppUN = \sum_{i = q + 1}^{+\infty} \AppU_{n, i} \Legendre_i,
\end{align}
where $\InterPoly$ denotes the $\SpaceLp{2}$ projection onto $\SpacePolynomials{q}((-1, 1))$.

Then, \Cref{lemma:legendre_interpolant} implies:
\begin{align}
    \AppUN - \InterpolantPQR \AppUN &= \sum_{i = q}^{+\infty} \AppU_{n, i} \Legendre_i - \left( \InterSol \AppUN(1) - \sum_{i = 0}^{q - 1} \AppU_{n, i} \right) \Legendre_q \notag \\
    &= \sum_{i = q}^{+\infty} \AppU_{n, i} \Legendre_i - \left( \sum_{i = q + 1}^{+\infty} \AppU_{n, i} \right) \Legendre_q \notag \\
    &= \AppUN - \InterPoly \AppUN - \left( \sum_{i = q + 1}^{+\infty} \AppU_{n, i} \right) \Legendre_q.
\end{align}

\begin{lemma}
    There exists $\BoundQ > 0$ such that:
    \begin{align}
        \left\lVert \sum_{i = q + 1}^{+\infty} \AppU_{n, i} \right\rVert_{\SpacePlaceholder} \leq \BoundQ \left\lVert \partial_t \AppUN \right\rVert_{\SpaceLp{2}((-1, 1); \SpacePlaceholder)}.
    \end{align}
\end{lemma}

\begin{lemma}
    It holds that:
    \begin{align}
        \left\lVert \partial_t \AppUN \right\rVert_{\SpaceLp{2}((-1, 1); \SpacePlaceholder)} = \sqrt{\frac{\tau_n}{2}} \left\lVert \partial_t \left( \InterSol u \right) \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)}
    \end{align}
\end{lemma}

\begin{proof}
    By $t = \RMap \left( \zeta \right)$, it follows that:
    \begin{align*}
        \left\lVert \partial_t \AppUN \right\rVert_{\SpaceLp{2}((-1, 1); \SpacePlaceholder)}^2 &= \left\lVert \partial_t \left( \InterSol u \circ \RMap \right) \right\rVert_{\SpaceLp{2}((-1, 1); \SpacePlaceholder)}^2 \\
        &= \frac{\tau_n}{2} \int_{I_n} \Norm{ \partial_t \left( \InterSol u \right) (t) }_{\SpacePlaceholder}^2 ~ dt = \left( \sqrt{\frac{\tau_n}{2}} \left\lVert \partial_t \left( \InterSol u \right) \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)} \right)^2
    \end{align*}
\end{proof}

\newpage
\begin{lemma}
    The following holds:
    \begin{align}
        \left\lVert u - \InterpolantPQ u \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)} &\leq \left\lVert u - \InterSol u \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)} + \left\lVert \InterSol u - \InterPolyN \InterSol u \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)} \\
        &+ \BoundQ \frac{\tau_n}{2} \left\lVert \partial_t \left( \InterSol u \right) - \partial_t w \right\rVert_{\SpaceLp{2}(I_n; \SpacePlaceholder)}, \notag
    \end{align}
    for all $w \in \SpaceSolutionFull$, where $\InterPolyN$ denotes the $\SpaceLp{2}$ projection onto $\SpacePolynomials{q}(I_n)$.
\end{lemma}

Assume, now, that the solution is sufficiently regular, that is:
\begin{align}
    u \in \SpaceRegular = \SpaceHk{q + 1}(I; \SpaceHk{1}(\Omega)) \cap C^0(I; \SpaceHk{p + 1}(\Omega)) &\text{ for some integers } p, q \geq 1.
\end{align}

\begin{lemma} % [!] Different time intervals, [!] to be fixed.
    There exist $\BoundInterp, \BoundPoly > 0$ such that, for all $v \in \SpaceRegular$:
    \begin{align}
        \left\lVert v(t) - \InterSol v(t) \right\rVert_{\SpaceLp{2}(K)} &\leq \BoundInterp h_n^{p + 1} \left\lvert v(t) \right\rvert_{\SpaceHk{p + 1}(K)}, \\
        \left\lvert v(t) - \InterSol v(t) \right\rvert_{\SpaceHk{1}(K)} &\leq \BoundInterp h_n^{p} \left\lvert v(t) \right\rvert_{\SpaceHk{p + 1}(K)},
    \end{align}
    for all $K \in \Omega_{h, n}$, for a.e. $t \in I_n$, and for all $n \in \TimeIndices$,
    \begin{align}
        \left\lVert v(t) - \InterSol v(t) \right\rVert_{\SpaceLp{2}(\Omega)} &\leq \BoundInterp h^{p + 1} \left\lvert v(t) \right\rvert_{\SpaceHk{p + 1}(\Omega)}, \\
        \left\lvert v(t) - \InterSol v(t) \right\rvert_{\SpaceHk{1}(\Omega, \Omega_{h, n})} &\leq \BoundInterp h^{p} \left\lvert v(t) \right\rvert_{\SpaceHk{p + 1}(\Omega)}, \\
        \left\lvert v(t) - \InterSol v(t) \right\rvert_{\SpaceHk{2}(\Omega, \Omega_{h, n})} &\leq \BoundInterp h^{p - 1} \left\lvert v(t) \right\rvert_{\SpaceHk{p + 1}(\Omega)},
    \end{align}
    for a.e. $t \in I$,
    \begin{align}
        \left\lVert v(\Vektor{x}) - \InterPolyN v(\Vektor{x}) \right\rVert_{\SpaceLp{2}(I_n)} &\leq \BoundPoly \tau_n^{q + 1} \left\lvert v(\Vektor{x}) \right\rvert_{\SpaceHk{q + 1}(I_n)}, \\
        \left\lvert v(\Vektor{x}) - \InterPolyN v(\Vektor{x}) \right\rvert_{\SpaceHk{1}(I_n)} &\leq \BoundPoly \tau_n^{q} \left\lvert v(\Vektor{x}) \right\rvert_{\SpaceHk{q + 1}(I_n)},
    \end{align}
    for $\omega$-a.e. $\Vektor{x} \in \Omega$.
\end{lemma}

\begin{lemma}
    There exists $\BoundH > 0$ such that:
    \begin{align}
        \left\lVert \InterSol w \right\rVert_{\SpaceLp{2}(K)} &\leq \left\lVert w \right\rVert_{\SpaceLp{2}(K)}, \\
        \left\lvert \InterSol w \right\rvert_{\SpaceHk{1}(K)} &\leq \BoundH \left\lvert w \right\rvert_{\SpaceHk{1}(K)},
    \end{align}
    for all $w \in \SpaceHk{1}(\Omega, \Omega_{h, n})$, for all $K \in \Omega_{h, n}$, and for all $n \in \TimeIndices$.
\end{lemma}

\newpage
\begin{lemma} \label{lemma:bounds}
    Assume that there exist $\BoundHT, \BoundHTVariant > 0$ such that:
    \begin{align}
        \frac{1}{\BoundHTVariant} h_K &\leq \tau_n \leq \BoundHT h_K &\text{ for all } K \in \Omega_{h, n} \text{ and for all } n \in \TimeIndices, \label{equation:ass_ht}
    \end{align}
    then:
    \begin{align}
        \int_{I_n} \left\lvert \eta \right\rvert_{\SpaceHk{1}(\Omega, \Omega_{h, n})}^2 ~ dt &\leq 3 \BoundInterp^2 h^{2p} \Seminorm{u}_{\SpaceLp{2}(I_n; \SpaceHk{p + 1}(\Omega))}^2 \label{eq:bound_1} \\
        &+ 3 \BoundH^2 \BoundPoly^2 \BoundQVariant \tau_n^{2q + 2} \Seminorm{u}_{\SpaceHk{q + 1}(I_n; \SpaceHk{1}(\Omega))}^2, \notag \\
        \TimeIntN{\Norm{\eta}_{\SpaceLp{2}(\Omega)}^2} & \leq 3 \BoundInterp^2 h^{2p + 2} \Seminorm{u}_{\SpaceLp{2}(I_n; \SpaceHk{p + 1}(\Omega))}^2 \label{eq:bound_2} \\
        &+ 3 \BoundPoly^2 \BoundQVariant \tau_n^{2q + 2} \Seminorm{u}_{\SpaceHk{q + 1}(I_n; \SpaceLp{2}(\Omega))}^2, \notag \\
        \TimeIntN{ \sum_{i \in \SpaceTimeIndices} h_{K_i}^{-2} \Norm{\eta}_{\SpaceLp{2}(K_i)}^2 } &\leq 3 \BoundInterp^2 h^{2p} \Seminorm{u}_{\SpaceLp{2}(I_n; \SpaceHk{p + 1}(\Omega))}^2 \label{eq:bound_3} \\
        &+  3 \BoundHT^2 \BoundPoly^2 \BoundQVariant \tau_n^{2q} \Seminorm{u}_{\SpaceHk{q + 1}(I_n; \SpaceLp{2}(\Omega))}^2, \notag \\
        \TimeIntN{J_{h, n}(\eta, \eta)} &\leq 6 \BoundTrace \BoundInterp^2 \BoundDeg h^{2p} \Seminorm{u}_{\SpaceLp{2}(I_n; \SpaceHk{p + 1}(\Omega))}^2 \label{eq:bound_4} \\
        &+ 3 \BoundPoly^2 \BoundQVariant \BoundDeg \tau_n^{2q} \left( 3 \BoundHT^2 \Seminorm{u}_{\SpaceHk{q + 1}(I_n; \SpaceLp{2}(\Omega))}^2 \right. \notag \\
        &+ \left.\BoundH^2 \tau_n^2 \Seminorm{u}_{\SpaceHk{q + 1}(I_n; \SpaceHk{1}(\Omega))}^2 \right), \notag \\
        \TimeIntN{ \sum_{i \in \SpaceTimeIndices} \left( \Norm{\eta}_{\Convection, \partial K_i \cap \partial \Omega}^2 + \Norm{\left[ \eta \right]}_{\Convection, \partial K_i^- \setminus \partial \Omega}^2 \right) } &\leq 3 \BoundTrace \BoundInterp^2 \BoundC{\Convection} h^{2p} \Seminorm{u}_{\SpaceLp{2}(I_n; \SpaceHk{p + 1}(\Omega))}^2 \label{eq:bound_5} \\
        &+ \frac{3}{2} \BoundTrace \BoundPoly^2 \BoundQVariant \BoundC{\Convection} \tau_n^{2q + 1} \left( 3 \BoundHT \Seminorm{u}_{\SpaceHk{q + 1}(I_n; \SpaceLp{2}(\Omega))}^2 \right. \notag \\
        &+ \left. \BoundH^2 h \tau_n \Seminorm{u}_{\SpaceHk{q + 1}(I_n; \SpaceHk{1}(\Omega))}^2 \right), \notag \\
        \TimeIntN{ \Seminorm{\eta}_{\SpaceHk{2}(\Omega, \Omega_{h, n})}^2 } &\leq 3 \BoundInterp^2 h^{2 \left( p - 1 \right)} \Seminorm{u}_{\SpaceLp{2}(I_n; \SpaceHk{p + 1}(\Omega))}^2 \label{eq:bound_6} \\
        &+ 3 \BoundH^2 \BoundInverse^2 \BoundPoly^2 \BoundQVariant \BoundHT^2 \tau_n^{2q} \Seminorm{u}_{\SpaceHk{q + 1}(I_n; \SpaceHk{1}(\Omega))}^2, \notag \\
        \sum_{n = 1}^{\nTimeIndices - 1} \Norm{\eta_n^-}_{\SpaceLp{2}(\Omega)}^2 &\leq \BoundInterp^2 \BoundHTVariant T h^{2p + 1} \Norm{u}_{C^0(\overline{I}; \SpaceHk{p + 1}(\Omega))}^2, \label{eq:bound_7}
    \end{align}
    for all $n \in \TimeIndices$, where:
    \begin{align}
        \BoundQVariant = 1 + \frac{1}{4} \BoundQ.
    \end{align}
\end{lemma}

\newpage
\subsection{Error Estimates}

The main result of the error analysis can now be stated.
\begin{theorem} \label{theorem:estimates_ht}
    Let assumptions in \cref{equation:ass_1,equation:ass_2,equation:ass_3,equation:ass_4,equation:ass_5,equation:ass_6,equation:ass_7,equation:ass_8,equation:ass_9,equation:ass_ht} be satisfied, let $u \in \SpaceRegular$ be the solution to the problem in \cref{equation:cdr} with the initial-boundary conditions in \cref{equation:cdr_dirichlet,equation:cdr_neumann,equation:cdr_initial}, and let $\AppU$ be the solution to the discrete problem in \cref{equation:cdr_discrete_short}, then there exists $C > 0$, independent of $h, \tau, \Diffusion$, such that $\Error = \AppU - u$ satisfies what follows:
    \begin{align}
        \sum_{n \in \TimeIndices} \TimeIntN{ \Norm{\Error}_{E, n}^2 } &\leq C h^{2p} \left( \Seminorm{u}_{\SpaceLp{2}(I; \SpaceHk{p + 1}(\Omega))}^2 + \Seminorm{u}_{C^0(\overline{I}; \SpaceHk{p + 1}(\Omega))}^2 \right) \\
        &+ C \tau^{2q} \left( \Seminorm{u}_{\SpaceHk{q + 1}(I; \SpaceLp{2}(\Omega))}^2 + \Seminorm{u}_{\SpaceHk{q + 1}(I; \SpaceHk{1}(\Omega))}^2 \right). \notag
    \end{align}
\end{theorem}
This estimate holds true even for $\Diffusion = 0$.

\begin{proof}
    From \Cref{lemma:abstract_estimates}, by \cref{eq:abstract_estimates_2}:
    \begin{align*}
        \sum_{n \in \TimeIndices} \int_{I_n} \left\lVert \Error \right\rVert_{E, n}^2 ~ dt &\leq C \sum_{n \in \TimeIndices} \int_{I_n} \theta_n^2(\eta; h, \Diffusion) ~ dt \\
        &+ C \sum_{n = 1}^{\nTimeIndices - 1} \left\lVert \eta_n^- \right\rVert_{\SpaceLp{2}(\Omega)}.
    \end{align*}

    It also follows, by \Cref{def:theta} and the \acrshort{cs} inequality, that:
    \begin{align*}
        \theta_n^2(\eta; h, \Diffusion) &\leq 4 \left( \left\lVert \eta \right\rVert_{E, n}^2 + \Diffusion h^2 \left\lvert \eta \right\rvert_{\SpaceHk{2}(\Omega, \Omega_{h, n})}^2 + \sum_{i \in \SpaceTimeIndices} \left( h_{K_i}^{-2} \left\lVert \eta \right\rVert_{\SpaceLp{2}(K_i)} + \left\lVert \eta_n^- \right\rVert_{\Convection, \partial K_i^- \setminus \partial \Omega} \right) \right),
    \end{align*}
    where:
    \begin{align*}
        \left\lVert \eta \right\rVert_{E, n}^2 &= \Diffusion \left\lvert \eta \right\rvert_{\SpaceHk{1}(\Omega, \Omega_{h, n})}^2 + \BoundC{\Reaction \Convection} \left\lVert \eta \right\rVert_{\SpaceLp{2}(\Omega)}^2 + \Diffusion J^{\kappa}_{h, n}(\eta, \eta) \\
        &+ \frac{1}{2} \sum_{i \in \SpaceTimeIndices} \left( \left\lVert \eta \right\rVert_{\Convection, \partial K_i \cap \partial \Omega}^2 + \left\lVert \eta \right\rVert_{\Convection, \partial K_i^- \setminus \partial \Omega}^2 \right).
    \end{align*}

    Hence:
    \begin{align*}
        \sum_{n \in \TimeIndices} \int_{I_n} \left\lVert \Error \right\rVert_{E, n}^2 ~ dt &\leq C \sum_{n \in \TimeIndices} \int_{I_n} \Diffusion \left\lvert \eta \right\rvert_{\SpaceHk{1}(\Omega, \Omega_{h, n})}^2 ~ dt + C \sum_{n \in \TimeIndices} \int_{I_n} \left\lVert \eta \right\rVert_{\SpaceLp{2}(\Omega)}^2 ~ dt \\
        &+ C \sum_{n \in \TimeIndices} \int_{I_n} \Diffusion J^{\kappa}_{h, n}(\eta, \eta) ~ dt \\
        &+ C \sum_{n \in \TimeIndices} \int_{I_n} \sum_{i \in \SpaceTimeIndices} \left( \left\lVert \eta \right\rVert_{\Convection, \partial K_i \cap \partial \Omega}^2 + \left\lVert \eta \right\rVert_{\Convection, \partial K_i^- \setminus \partial \Omega}^2 \right) ~ dt \\
        &+ C \sum_{n \in \TimeIndices} \int_{I_n} \Diffusion h^2 \left\lvert \eta \right\rvert_{\SpaceHk{2}(\Omega, \Omega_{h, n})}^2 ~ dt \\
        &+ C \sum_{n \in \TimeIndices} \int_{I_n} \sum_{i \in \SpaceTimeIndices} \left( h_{K_i}^{-2} \left\lVert \eta \right\rVert_{\SpaceLp{2}(K_i)} + \left\lVert \eta_n^- \right\rVert_{\Convection, \partial K_i^- \setminus \partial \Omega} \right) ~ dt \\
        &+ C \sum_{n = 1}^{\nTimeIndices - 1} \left\lVert \eta_n^- \right\rVert_{\SpaceLp{2}(\Omega)}.
    \end{align*}

    From \Cref{lemma:bounds}, by \cref{eq:bound_1,eq:bound_2,eq:bound_3,eq:bound_4,eq:bound_5,eq:bound_6,eq:bound_7}:
    \begin{align*}
        \sum_{n \in \TimeIndices} \int_{I_n} \left\lVert \Error \right\rVert_{E, n}^2 ~ dt &\leq C \sum_{n \in \TimeIndices} h^{2p} \Seminorm{u}_{\SpaceLp{2}(I_n; \SpaceHk{p + 1}(\Omega))}^2 \\
        &+ C \sum_{n \in \TimeIndices} \tau_n^{2 q} \left( \Seminorm{u}_{\SpaceHk{q + 1}(I_n; \SpaceLp{2}(\Omega))}^2 + \Seminorm{u}_{\SpaceHk{q + 1}(I_n; \SpaceHk{1}(\Omega))}^2 \right) \\
        &+ C h^{2p + 1} \Norm{u}_{C^0(\overline{I}; \SpaceHk{p + 1}(\Omega))}^2,
    \end{align*}
    where only the lowest-order terms are retained.

    Finally, owing to the regularity assumptions on $u$:
    \begin{align*}
        \sum_{n \in \TimeIndices} \TimeIntN{ \Norm{\Error}_{E, n}^2 } &\leq C h^{2p} \left( \Seminorm{u}_{\SpaceLp{2}(I; \SpaceHk{p + 1}(\Omega))}^2 + \Seminorm{u}_{C^0(\overline{I}; \SpaceHk{p + 1}(\Omega))}^2 \right) \\
        &+ C \tau^{2q} \left( \Seminorm{u}_{\SpaceHk{q + 1}(I; \SpaceLp{2}(\Omega))}^2 + \Seminorm{u}_{\SpaceHk{q + 1}(I; \SpaceHk{1}(\Omega))}^2 \right).
    \end{align*}
\end{proof}