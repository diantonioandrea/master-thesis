\section{Bochner Spaces}

The Bochner spaces introduced in this section provide an ideal setting for studying and characterizing time-dependent \acrshort{pdes}, by considering, following \cite[p. 111]{Ern2021}, functions defined on a bounded time interval $I \subset \R$, with values in a Banach (or Hilbert) space of functions defined on the space domain $\Omega \subset \Rd{d}$.

\subsection{Bochner Integral}

Let $I \subset \R$ be open, nonempty and bounded and let $V$ be a Banach space. Moreover, equip $I$ with its own $\sigma$-algebra $\SI$ and with the Lebesgue measure $\lambda$.

\begin{definition}[Simple functions]
    A function $u\colon I \rightarrow V$ is said to be a simple function if there exist $N \in \N$, $\left\{ v_n \right\}_{n = 1}^N \subset V$ and $\left\{ A_n \right\}_{n = 1}^N \subset \SI$ disjoint such that:
    \begin{gather}
        u(t) = \sum_{n = 1}^N v_n \characteristic{A_n} \text{ for all } t \in I.
    \end{gather}

    Moreover, the Bochner integral of a simple function is defined as:
    \begin{gather}
        \int_I u(t) ~ d \lambda  = \sum_{n = 1}^N v_n \lambda(A_n) \in V.
    \end{gather}
\end{definition}

\begin{lemma}
    \begin{gather}
        \lVert \int_I u(t) ~ d \lambda \rVert_V \leq \int_I \lVert u(t) \rVert_V ~ d \lambda \text{ for all simple functions } u.
    \end{gather}
\end{lemma}

\begin{definition}[Strongly measurable function]
    A function $u\colon I \rightarrow V$ is said to be strongly measurable if there exist $\left\{ f_n \right\}_{n \in N}$ simple functions such that:
    \begin{gather}
        \lim_{n \rightarrow \infty} \lVert u(t) - f_n(t) \rVert_V = 0 \text{ for } \lambda \text{-a.e. } t \in I.
    \end{gather}
\end{definition}

\begin{lemma}
    Let $u\colon I \rightarrow V$ be a strongly measurable function, then $\lVert u(\cdot) \rVert_V \colon I \rightarrow \R$ is Lebesgue-measurable.
\end{lemma}

\begin{definition}[Bochner integrable function] \label{definition:bochner_integrable}
    A function $u\colon I \rightarrow V$ is said to be Bochner integrable if there exist $\left\{ f_n \right\}_{n \in N}$ simple functions such that:
    \begin{gather}
        \lim_{n \rightarrow \infty} \lVert u(t) - f_n(t) \rVert_V = 0 \text{ for } \lambda \text{-a.e. } t \in I,
    \end{gather}
    that is  $u$ is strongly measurable, and:
    \begin{gather}
        \lim_{n \rightarrow \infty} \int_I \lVert u(t) - f_n(t) \rVert_V ~ d \lambda = 0.
    \end{gather}
\end{definition}

\begin{lemma}
    Let $u\colon I \rightarrow V$ be a Bochner integrable function and $\left\{ f_n \right\}_{n \in \N}$ as in \ref{definition:bochner_integrable}, then $\left\{ \int_I f_n(t) ~ d \lambda \right\}_{n \in \N}$ converges in $V$ with respect to $\lVert \cdot \rVert_V$.
\end{lemma}

\begin{definition}[Bochner integral]
    Let $u\colon I \rightarrow V$ be a Bochner integrable function and $\left\{ f_n \right\}_{n \in \N}$ as in \ref{definition:bochner_integrable}, then the Bochner integral of $u$ is defined as:
    \begin{gather}
        \int_I u(t) ~ d \lambda = \lim_{n \rightarrow \infty} \int_I f_n(t) ~ d \lambda.
    \end{gather}
\end{definition}

\begin{theorem}[Bochner]
    Let $u\colon I \rightarrow V$ be a strongly measurable function, then $u$ is Bochner integrable if and only if:
    \begin{gather}
        \int_I \lVert u(t) \rVert_V ~ d \lambda < + \infty.
    \end{gather}
\end{theorem}

\newpage
\subsection{Definition and Main Properties}

\begin{corollary}[Linear maps]
    Let $W$ be a Banach space and $F$ be a bounded linear operator from $V$ to $W$. Let $u\colon I \rightarrow V$ be a Bochner integrable function and define $F(u) \colon I \rightarrow W$ for which:
    \begin{gather}
        F(u)(t) = F(u(t)) \text{ for } \lambda \text{-a.e. } t \in I,
    \end{gather}
    then $F(u)$ is a Bochner integrable function and:
    \begin{gather}
        \int_I F(u)(t) ~ d \lambda = F\left( \int_I u(t) ~ d \lambda \right).
    \end{gather}
\end{corollary}

\begin{remark} % [!] Ugly \left and \right with \langle and \rangle.
    Let $u\colon I \rightarrow V$ be a Bochner integrable function and let $\phi \in V^*$, then:
    \begin{gather}
        \int_I \left\langle \phi, (u)(t) \right\rangle_{V^*, V} ~ d \lambda = \left\langle \phi, \int_I u(t) ~ d \lambda \right\rangle_{V^*, V}.
    \end{gather}
\end{remark}

\begin{remark}[Embedding]
    Let $u\colon I \rightarrow V$ be a Bochner integrable function and let $W$ be a Banach space such that $V \hookrightarrow W$. Denote by $F_{V \rightarrow W} \colon V \rightarrow W$ the canonical embedding, then:
    \begin{gather}
        \int_I F_{V \rightarrow W}(u)(t) ~ d \lambda = F_{V \rightarrow W}\left( \int_I u(t) ~ d \lambda \right),
    \end{gather}
    leading to a useful identification between the $V$-valued and the $W$-valued integrals.
\end{remark}

\begin{definition}[$\Lp{p}(I; V)$]
    Let $1 \leq p \leq +\infty$, then:
    \begin{gather}
        \Lp{p}(I; V) = \left\{ u \colon I \rightarrow V \text{ strongly measurable such that } \lVert u \rVert_{\Lp{p}(I; V)} < +\infty \right\},
    \end{gather}
    where:
    \begin{align}
        & \lVert u \rVert_{\Lp{p}(I; V)} = \left( \int_I \lVert u(t) \rVert_V^p ~ d \lambda \right)^{1/p} & \text{ if } p < +\infty, \\
        & \lVert u \rVert_{\Lp{\infty}(I; V)} = \esssup_{t \in I} \left\{ \lVert u(t) \rVert_V \right\} & \text{ if } p = +\infty.
    \end{align}
\end{definition}

\begin{theorem}
    Let $1 \leq p \leq +\infty$, then $\Lp{p}(I; V)$ is a Banach space.
\end{theorem}

\begin{theorem}
    Let $1 \leq p \leq +\infty$ and let $V$ be reflexive, then $\left( \Lp{p}(I; V) \right)^*$ is a isometrically isomorphic to $\Lp{p^{\prime}}(I; V^*)$.

    Furthermore, $\Lp{p}(I; V)$ is reflexive for all $1 < p < +\infty$.
\end{theorem}

\newpage
\subsection{Weak Time Derivative}

Set $I = (0, T)$ for $T \in (0, +\infty)$ for the entirety of this section.

\begin{definition}[Continuity]
    A function $u\colon I \rightarrow V$ is said to be continuous at $t \in I$ if for every $\left\{ t_n \right\}_{n \in \N}$ which converges to $t$, the sequence $\left\{ u(t_n) \right\}_{n \in \N}$ converges to $u(t)$ in $V$.

    Moreover, $u$ is said to be continuous if it is continuous for all $t \in I$.
\end{definition}

\begin{definition}[Strongly differentiable function]
    A function $u\colon I \rightarrow V$ is said to be strongly differentiable at $t \in I$ if it is continuous in a neighbourhood of $t$ and the ratio:
    \begin{gather}
        \frac{u(t + \tau) - u(t)}{\tau}
    \end{gather}
    converges in $V$ as $\tau \rightarrow 0$.

    The limit is then denoted by $u_t(t) \in V$.
\end{definition}

\begin{theorem}[Lebesgue's differentiation]
    Let $u \in \Lp{1}(I; V)$ and:
    \begin{gather}
        F(t) = \int_0^t u(s) ~ d \lambda \text{ for all } t \in I,
    \end{gather}
    then $F$ is strongly differentiable for $\lambda$-a.e. $t \in I$ and $F_t(t) = u(t)$ for $\lambda$-a.e. $t \in I$.
\end{theorem}

\begin{definition}[$\Lp{1}_{loc}(I; V)$]
    \begin{gather}
        \Lp{1}_{loc}(I; V) = \left\{ u\colon I \rightarrow V  \text{ such that } u \in \Lp{1}(K; V) \text{ for all } K \subset \subset I \right\}.
    \end{gather}
\end{definition}

\begin{corollary}[Vanishing integrals]
    Let $u \in \Lp{1}_{loc}(I; V)$ be such that:
    \begin{gather}
        \int_I u(t) \phi(t) ~ d \lambda = 0 \text{ for all } \phi \in C_c^{\infty}(I; \R),
    \end{gather}
    then $u(t) = 0$ for $\lambda$-a.e. $t \in I$.
\end{corollary}

\begin{definition}[Weakly differentiable function]
    A function $u \in \Lp{1}_{loc}(I; V)$ is said to be weakly differentiable if there exists $v \in \Lp{1}_{loc}(I; V)$ such that:
    \begin{gather}
        - \int_I \phi^{\prime}(t) u(t) = \int_I \phi(t) v(t) \text{ for all } \phi \in C_c^{\infty}(I; \R).
    \end{gather}
    Its weak derivative is denoted by $u_t$ when unambiguous.
\end{definition}

\begin{lemma}
    Let $u \in \Lp{1}_{loc}(I; V)$ weakly differentiable be such that $u_t(t) = 0$ for $\lambda$-a.e. $t \in I$, then there exists $a \in V$ such that $u(t) = a$ for $\lambda$-a.e. $t \in I$.
\end{lemma}

\begin{theorem}[Fundamental theorem of calculus]
    Let $u, v \in \Lp{1}(I; V)$, then $u$ is weakly differentiable with $v = u_t$ if and only if there exists $a \in V$ such that:
    \begin{gather}
        u(t) = a + \int_0^t v(s) ~ d \lambda \text{ for } \lambda \text{-a.e.} t \in I.
    \end{gather}
\end{theorem}

\begin{corollary}
    Let $u \in \Lp{1}(I; V)$ be weakly differentiable, then it is strongly differentiable for $\lambda$-a.e. $t \in I$ and its strong and weak derivatives coincide.
\end{corollary}

\begin{lemma}[Linear maps]
    Let $W$ be a Banach space and $F$ be a linear operator from $V$ to $W$, then for all $u \in \Lp{1}_{loc}(I; V)$ weakly differentiable, $F(u) \in \Lp{1}_{loc}(I; W)$ is weakly differentiable and:
    \begin{gather}
        F(u_t) = F_t(u) \in \Lp{1}_{loc}(I; W).
    \end{gather}
\end{lemma}

\newpage
\subsection{Function Spaces with Weak Time Derivative}

Let $V, W$ Banach spaces such that $V \hookrightarrow W$ with $F_{V \rightarrow W}$ canonical embedding.

\begin{definition}[$\Xpq{}{q}(I; V, W)$]
    Let $1 \leq p, q \leq +\infty$, then:
    \begin{gather}
        \Xpq{p}{q}(I; V, W) = \left\{ u \in \Lp{p}(I; V) \text{ for which } u_t \in \Lp{q}(I; W) \right\}
    \end{gather}

    Moreover, $\Xpq{}{q}(I; V, W)$ is equipped with the norm $\lVert \cdot \rVert_{\Xpq{}{q}(I; V, W)}$, such that for all $u \in \\Xpq{P}{q}(I; V, W)$:
    \begin{gather}
        \lVert u \rVert_{\Xpq{}{q}(I; V, W)} = \lVert u \rVert_{\Lp{p}(I; V)} + \lVert F_{V \rightarrow W} \rVert_{\mathcal{L}(V;W)}^{-1}T^{1 + \frac{1}{p} - \frac{1}{q}} \lVert u_t \rVert_{\Lp{q}(I; W)}.
    \end{gather}
\end{definition}

\begin{theorem}
    $C^{\infty}(\overline{I}; V)$ is dense in $\Xpq{}{q}(I; V, W)$.
\end{theorem}

\begin{lemma} % [!] Fix embedding for Sobolev spaces.
    \begin{align}
        & \Xpq{p}{q}(I; V, W) \hookrightarrow C^{0, 1 - \frac{1}{q}}(\overline{I}; W) & \text{ if q > 1}, \\
        & \Xpq{p}{q}(I; V, W) \hookrightarrow C^{0}(\overline{I}; W) & \text{ if q = 1}.
    \end{align}
\end{lemma}

\begin{theorem}
    Let $Y$ be a Banach space such that $V \hookrightarrow Y \hookrightarrow W$ and assume that $V \hookrightarrow \hookrightarrow Y$, then:
    \begin{gather}
        \Xpq{p}{q}(I; V, W) \hookrightarrow \hookrightarrow \Lp{p}(I; Y) \text{ for all } 1 \leq p, q < +\infty,\\
        \Xpq{\infty}{q}(I; V, W) \hookrightarrow \hookrightarrow C^0(\overline{I}; Y) \text{ for all } q > 1.
    \end{gather}
\end{theorem}

\begin{definition}[Gelfand triple] \label{definition:gelfand}
    Let now $V, W$ be separable Hilbert spaces such that $V \hookrightarrow W$ and $V$ is dense in $W$. Moreover, identify $W$ with its dual space $W^*$. A triple $\left( V, W \equiv W^*, V^* \right)$ is said to be a Gelfand triple.
\end{definition}

\begin{definition}[$\X(I; V, V^*)$] \label{definition:x}
    \begin{gather}
        \X(I; V, V^*) = \Xpq{2}{2}(I; V, V^*) = \left\{ u \in \Lp{2}(I; V) \text{ for which } u_t \in \Lp{2}(I; V^*) \right\}
    \end{gather}
\end{definition}

\begin{theorem}[Time trace and integration by parts]
    Let $\left( V, W \equiv W^*, V^* \right)$ be a Gelfand triple. Then $\X(I; V, V^*) \hookrightarrow C^0(\overline{I};W)$, and the map that associates $u(0) \in W$ to each $u \in \X(I; V, V^*)$ is surjective.

    Moreover, for all $u, v \in \X(I; V, V^*)$:
    \begin{gather}
        \int_I \langle u_t(t), v(t) \rangle_{V^*, V} ~ d \lambda = - \int_I \langle v_t(t), u(t) \rangle_{V^*, V} ~ d \lambda + \left( u(T), v(T) \right)_W - \left( u(0), v(0) \right)_W.
    \end{gather}
\end{theorem}

\newpage
\section{Weak Formulation of the Model Parabolic Problem}

Let $V, W$ and $\X$ as in \ref{definition:gelfand} and \ref{definition:x}.

\subsection{Model Problem}

\begin{definition}[A] \label{definition:A}
    Let $A \colon I \rightarrow \mathcal{L}(V;V^*)$ be an operator such that the map that associates $\langle A(t)(u), v \rangle_{V^*, V}$ to $t \in I$ is measurable for all $u, v \in V$. Moreover there exist $C, \alpha > 0$ such that:
    \begin{align} \label{equation:a}
        & \lVert A(t)(u) \rVert_{V^*} \leq C \lVert u \rVert_V \text{ for all } u \in V \text{ and for } \lambda \text{-a.e. } t \in I, \\
        & \langle A(t)(u), u \rangle_{V^*, V} \geq \alpha \lVert u \rVert_V^2 \text{ for all } u \in V \text{ and for } \lambda \text{-a.e. } t \in I.
    \end{align}
\end{definition}

\begin{lemma}
    Let $1 \leq p \leq +\infty$ and  $A$ as in \ref{definition:A}, then for all $u \in \Lp{p}(I; V)$ the function $A(u) \colon I \rightarrow V^*$ such that $A(u)(t) = A(t)(u(t))$ is strongly measurable. Moreover $A(u) \in \Lp{p}(I; V^*)$ with:
    \begin{gather}
        \lVert A(u) \rVert_{\Lp{p}(I; V^*)} \leq C \lVert u \rVert_{\Lp{p}(I; V)}.
    \end{gather}
\end{lemma}

\begin{definition}[Model problem] \label{definition:model}
    Let $f \in \Lp{2}(I; V^*)$, the model problem is to find $u \in \X(I; V, V^*)$ such that:
    \begin{gather}
        \begin{cases}
            u_t(t) + A(u)(t) = f(t) & \text{ in } \Lp{2}(I; V^*), \\
            u(0) = u_0 & \text{ in } W.
        \end{cases}
    \end{gather}
\end{definition}

\newpage
\subsection{Weak Formulation}

\begin{definition}[Trial and test spaces]
    Let $\TX = \X(I; V, V^*)$ be the trial space and let $\TY = \TY_0 \times \TY_1$ be the test space where $\TY_0 = W$ and $\TY_1 = \Lp{2}(I; V)$.
\end{definition}

\begin{definition}[$b$ and $l$]
    Let $b \colon \TX \times \TY \rightarrow \R$ and $l \colon \TY \rightarrow \R$ be such that for all $u \in \TX$ and all $y = (y_0, y_1) \in \TY$:
    \begin{align}
        & b(u, y) = \left( u(0), y_0 \right)_W + \int_I \langle u_t(t) + A(u)(t), y_1(t) \rangle_{V^*, V} ~ d \lambda, \\
        & l(y) = \left( u_0, y_0 \right)_W + \int_I \langle f(t), y_1(t) \rangle_{V^*, V} ~ d \lambda.
    \end{align}
\end{definition}

\begin{definition}[Weak formulation]
    The weak formulation of \ref{definition:model} is to find $u \in \TX$ such that:
    \begin{gather}
        b(u, y) = l(y) \text{ for all } y \in \TY. \label{equation:weak}
    \end{gather}
\end{definition}

\begin{definition}[Parabolic equation]
    Let $f \in \Lp{2}(I; V^*)$ and $u_0 \in W$, then \eqref{equation:weak} is said to be parabolic if $A$ satisfies \eqref{equation:a}.
\end{definition}

\begin{lemma}[Weak solution]
    Let $u \in \TX$ solution of \eqref{equation:weak}, then $u_t(t) + A(u)(t) = f(t)$ for $\lambda$-a.e. $t \in I$ and $u(0) = u_0$ in $W$.
\end{lemma}

\newpage
\subsection{Well-Posedeness}

The objective of this section is to establish the well-posedness of the parabolic model problem \eqref{equation:weak}.

\subsubsection{Uniqueness}

\begin{lemma}[Uniqueness and a priori estimate]
    Let $u \in \TX$ solution of \eqref{equation:weak}, then \eqref{equation:weak} admits at most one solution and:
    \begin{gather}
        \alpha \lVert u \rVert_{\Lp{2}(I; V)}^2 + \lVert u(T) \rVert_W^2 \leq \frac{1}{\alpha} \lVert f \rVert_{\Lp{2}(I; V^*)}^2 + \lVert u_0 \rVert_W^2.
    \end{gather}
\end{lemma}

% [!] Proof to be included.

% \begin{lemma}[$W$-norm estimate]
%     % [!]
% \end{lemma}

\subsubsection{Existence}

\begin{lemma}[Existence]
    There exists $u \in \TX$ solution of \eqref{equation:weak}.
\end{lemma}

% [!] Proof to be included.

\newpage
\section{Discretization of the Model Parabolic Problem}

\subsection{Conforming Semi-Discretization in Space}

Set $a(t; u, v) = \langle A(t)(u), v \rangle_{V^*, V}$ for all $u, v \in V$ and for $\lambda$-a.e. $t \in I$.

\begin{definition}[$b$ and $l$]
    Let $b \colon \TX \times \TY \rightarrow \R$ and $l \colon \TY \rightarrow \R$ be such that for all $u \in \TX$ and all $y = (y_0, y_1) \in \TY$:
    \begin{align}
        & b(u, y) = \left( u(0), y_0 \right)_W + \int_I \left( \langle u_t(t), y_1(t) \rangle_{V^*, V} + a(t; u(t), y_1(t)) \right)~ d \lambda, \\
        & l(y) = \left( u_0, y_0 \right)_W + \int_I \langle f(t), y_1(t) \rangle_{V^*, V} ~ d \lambda.
    \end{align}
\end{definition}

Let $\left\{ V_h \right\}_{h \in \Hs}$ be a sequence of finite-dimensional subspaces of $V$ constructed using a finite element and a shape-regular mesh family $\left\{ \Tau_h \right\}_{h \in \Hs}$, which is fixed in time, such that each mesh exactly covers $\Omega$.

Let $\left\{ \varphi_j \right\}_{j \in J_h}$ be a basis for $V_h$.

\begin{definition}[Semi-discrete trial and test spaces]
    Let $\TX_h = \X(I; V, V^*) = \Hk{1}(I; V_h)$ be the semi-discrete trial space and let $\TY_h = V_h \times \Lp{2}(I; V_h)$ be the semi-discrete test space.
\end{definition}

Observe that $\TX_h \subset \TX$, $\TY_h \subset \TY$, and a generic $u_h \in \TX_h$ is of the form of:
\begin{gather}
    u_h(t, \Vector{x}) = \sum_{j \in J_h} u_j(t) \varphi_j(\Vector{x}),
\end{gather}
and:
\begin{gather}
    u_{t, h}(t, \Vector{x}) = \sum_{j \in J_h} u_j^{\prime}(t) \varphi_j(\Vector{x}),
\end{gather}
with $u_j \in \Hk{1}(I)$ for all $j \in J_h$. Similarly, a generic $y_h \in \TY_h$ is a pair $(y_{0h}, y_{1h})$ where $y_{0h} \in V_h$ and $y_{1h}$ is of the form of:
\begin{gather}
    y_{1h}(t, \Vector{x}) = \sum_{j \in J_h} y_j(t) \varphi_j(\Vector{x}),
\end{gather}
with $y_j \in \Lp{2}(I)$ for all $j \in J_h$.

\begin{definition}[Semi-discrete weak formulation]
    The semi-discrete weak formulation of \ref{definition:model} is to find $u_h \in \TX_h$ such that:
    \begin{gather} \label{equation:weak_h1}
        b(u_h, y_h) = l(y_h) \text{ for all } y_h \in \TY_h.
    \end{gather}
\end{definition}

\begin{definition}[$\proj{V_h}$]
    Let $\proj{V_h} \colon W \rightarrow V_h$ be the $W$-orthogonal projection, that is, for all $w \in W$, $\proj{V_h}(w)$ is the unique element in $V_h$ such that:
    \begin{gather}
        \left( w - \proj{V_h}(w), v_h \right)_W = 0 \text{ for all } v_h \in V_h.
    \end{gather}
\end{definition}

\begin{proposition}[Equivalence]
    $u_h \in \TX_h$ solves \eqref{equation:weak_h1} if and only if for all $v_h \in V_h$:
    \begin{gather}
        \begin{cases} \label{equation:weak_h2}
            \left( u_{t, h}(t), v_h \right)_W + a(t; u_h(t), v_h) = \langle f(t), v_h \rangle_{V^*, V} \text{ in } \Lp{2}(I), \\
            u_h(0) = \proj{V_h}(u_0),
        \end{cases}
    \end{gather}
    and both \eqref{equation:weak_h1} and \eqref{equation:weak_h2} are well-posed.

    Moreover, if $f \in C^0(\overline{I}; V^*)$ and $A \in C^0(\overline{I}; \mathcal{L}(V; V^*))$, $u_h \in C^1(\overline{I}; V_h)$.
\end{proposition}